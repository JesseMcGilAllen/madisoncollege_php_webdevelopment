<!DOCTYPE html PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html>
<head>
<meta name="generator" content="HTML Tidy, see www.w3.org">
<title>PHP and MySQL</title>
<link href="../../../css/basic.css" rel="stylesheet" type="text/css">
<script type="text/javascript" language="JavaScript">
<!--
function putSemester() {
    var today=new Date();
    var thisMonth=today.getMonth()+1;
    var thisYear=today.getFullYear();
    if(thisMonth <=6) {
        return "Spring, " + thisYear;
    }
    else {
       return "Fall, " + thisYear;
    }
}//-->
</script>
<style type="text/css">
<!--
    .bgStripes {
        background-image:url(../../../images/Xstripes.gif);
        background-attachment: fixed;
    }
    body {
        background-color:white;
    }
    strong {
        font-family: Arial, Helvetica, sans-serif;
    }
-->
</style>
</head>
<body style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<table class="bgStripes" border="0" width="100%">
<tbody>
<tr name="firstRow">
<td valign="top" width="80"><span style="font-size: x-small; font-weight: bold;">
<script type="text/javascript">
<!--
    document.write(putSemester());
-->
</script>
</span> <br />
</td>
<td style="text-align: center;"><span style="font-weight: bold; font-size: medium; color: darkblue;">
PHP Web Development with MySQL
</span> </td>
<td align="right" valign="top" width="80"><span style="font-size: x-small; font-weight: bold;">
3 Credits</span> </td>
</tr>
<tr>
<td colspan="3" style="text-align: center;"><span style="font-size: xx-small; font-weight: bold;">
152-166</span> </td>
</tr>
</tbody>
</table>
<!--The heading for the slides --> <br />
<table class="headTable1" border="0">
<tbody>
<tr>
<td width="100"><a href="index.html"><img alt="" src="../../../images/btn_lArrow.gif" border="0"></a><a href="index.html"><img alt="" src="../../../images/btn_upArrow.gif" border="0"></a><a href="phpmysql2.html"><img alt="" src="../../../images/btn_rArrow.gif" border="0"></a></td>
<td>PHP and MySQL Integration</td>
</tr>
</tbody>
</table>
<br />
<div class="disp1">
<ul class="slidesUl1">
<li><p>
The user has filled out a form and submitted it. It contains a list of items he
or she wants to purchase. The information for that user is stored in a database
table named "customers".
</p><p>
You want to retrieve all the orders and product information for that customer
from the database and display selected data on the Web page directly from your
PHP script. Now you will learn how to integrate PHP and MySQL.
</p><p>
PHP provides built-in functions that allow all the necessary operations for
opening and selecting the database, and for sending it SQL queries to create
tables, update and delete them, retrieve records, and display the results.
</p></li>
<li><p>
<b>Note:</b>
Actually PHP has multiple function libraries for database connecivity to MySQL
and most other popular database management systems (DBMSs). In this class we use
the MySQL Function Library, which provides connectivity to MySQL only, and
is characterized by the fact that all of its member functions use the prefix
"mysql_".
</p><p>
Other commonly used libraries for database connectivity are:
</p>
<ul>
<li><p>
<b><i>MySQL-Improved Function Library</i></b> - A function library intended to
replace the MySQL Function Library. It provides both Object-Oriented methods and
traditional functions for MySQL connectivity. The functions all use the prefix
"mysqli_" and most of their names are otherwise the same as the corresponding
(older) MySQL Library functions.
</p></li>
<li><p>
<b><i>DB Object-Oriented Library</i></b> - Available as a package in the PHP Extension
and Application Repository (PEAR), DB provides connectivity for all major DBMSs.
DB was the most common way to connect to DBMSs other than MySQL, prior to the
introduction of PDO for PHP5.
</p></li>
<li><p>
<b><i>PHP5 Data Object Abstraction Layer (PDO)</i></b> - PDO is the new data
abstraction layer for PHP version 5. It provides connectivity to all major DBMSs,
and is currently the recommended database connectivity solution for new PHP
applications. (We will use PDO extensively in the advanced PHP courses.)
</p></li>
</ul>
</li>
<li><p>
You can create your HTML form, process it, and connect to the MySQL database
all in one PHP program!
</p><p>
At the beginning of this book, we described PHP and MySQL as a perfect marriage.
In this unit, we see how that marriage works.
</p></li>
<li><p>
Connecting to the Database Server
</p><p>
To establish a connection to the MySQL database server from your PHP script,
you can use the PHP <b>mysql_connect()</b> function.
</p><p>
Format:
</p>
<code><small><pre>
resource mysql_connect ( [string server [, string username [,
                         string password [, bool new_link [,
                         int client_flags]]]]] )
</pre></small></code>
<p>
Example:
</p>
<code><small>
$link = mysql_connect('localhost','user','password');<br />
</small></code>
<p>
The first argument is the host server where the MySQL server will be running.
It can also include an IP address, port number, a path to a local socket,
and so on.
</p><p>
The second argument is the username, the name associated with the MySQL user
account having access to the database or schema we want to use.
</p><p>
The third argument is the password associated with the MySQL user account.
</p><p>
If a second call is made to mysql_connect() with the same arguments,
a new link will not be established, but instead, the link identifier of the
already opened link will be returned.
</p><p>
If you specify the "new_link" parameter, mysql_connect() will always open a new link.
</p><p>
If the connection is successful, mysql_connect() returns the connection link
and if not, the function returns FALSE.
</p><p>
The resource returned points to the database server and is used by all the
other mysql functions in the script.
</p><p>
When a Web page or PHP script ends, the database is automatically closed and
the resource that links to it is released, so that if you start another page
you will have to reconnect to the database.
</p><p>
If you want to close the database before the program ends, PHP provides the
<b>mysql_close()</b> function. The mysql_close() function closes the connection
to the MySQL server referenced by the link.
</p><p>
Format:
</p>
<blockquote><code><small>
bool mysql_close ( [resource link_identifier]<br />
</small></code></blockquote>
<p>
Example:
</p>
<blockquote><code>
mysql_close($link);
</code></blockquote>
<h4>
Filename: dbconnect.php
</h4>
<blockquote><small>
<div class="disp2">
<PRE>
<span class="syntax0"><span class="gutter">   1:</span><span class="syntax17">&lt;?php</span>
<span class="gutter">   2:</span>  <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">Opening</span><span class="syntax13"> </span><span class="syntax13">a</span><span class="syntax13"> </span><span class="syntax13">connection</span><span class="syntax13"> </span><span class="syntax13">to</span><span class="syntax13"> </span><span class="syntax13">the</span><span class="syntax13"> </span><span class="syntax13">MySQL</span><span class="syntax13"> </span><span class="syntax13">database</span><span class="syntax13"> </span><span class="syntax13">server&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">   3:</span>  <span class="syntax10">$</span><span class="syntax10">link</span> <span class="syntax18">=</span> <span class="syntax9">mysql_connect</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">localhost</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">djefferson</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">dino1234</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   4:</span>  <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span>
<span class="gutterH">   5:</span>    <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Connection</span><span class="syntax13"> </span><span class="syntax13">to</span><span class="syntax13"> </span><span class="syntax13">MySQL</span><span class="syntax13"> </span><span class="syntax13">server</span><span class="syntax13"> </span><span class="syntax13">failed!</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   6:</span>  <span class="syntax8">print</span> <span class="syntax14">&quot;</span><span class="syntax14">Connection</span><span class="syntax14"> </span><span class="syntax14">to</span><span class="syntax14"> </span><span class="syntax14">MySQL</span><span class="syntax14"> </span><span class="syntax14">worked</span><span class="syntax14">.</span><span class="syntax14"> </span><span class="syntax14">The</span><span class="syntax14"> </span><span class="syntax14">link</span><span class="syntax14"> </span><span class="syntax14">is</span><span class="syntax14">:</span><span class="syntax14"> </span><span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax14"> </span><span class="syntax14">&lt;</span><span class="syntax14">br</span><span class="syntax14"> </span><span class="syntax14">/</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
<span class="gutter">   7:</span>  <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">Closing</span><span class="syntax13"> </span><span class="syntax13">the</span><span class="syntax13"> </span><span class="syntax13">connection&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">   8:</span>  <span class="syntax9">mysql_close</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   9:</span><span class="syntax17">?&gt;</span></span>
</PRE>
</div>
</small></blockquote>
<p>
The PHP <b>mysql_connect()</b> function connects to a MySQL database server
running on "localhost" using a valid username and password.
</p><p>
If the connection succeeeds, the message on line 6 is printed, including the
value of the resource variable $link.
</p><p>
If the connection fails, $link contains the Boolean value FALSE, and the script
exits with a message at line 5.
</p><p>
The <b>mysql_close()</b> function closes the connection to the database
previously opened by mysql_connect(). mysql_close() is not necessary because
the connection will automatically be closed when the script ends.
</p></li>
<li><p>
Choosing the Database
</p><p>
Once connected to the database server, the next step is to set the MySQL default
database to the one that you will be using.
</p><p>
The <b>mysql_select_database()</b> function is used to select a MySQL database.
<b>Note:</b> This is the equivalent to the use command when using mysql client.
</p><p>
The first argument is the name of the database. The second argument is the
MySQL connection resource variable (the link) established when the
mysql_connect() function was executed.
</p><p>
Format:
</p>
<code><small><pre>
bool mysql_select_db ( string database_name [,
                       resource link_identifier] )
</pre></small></code>
<p>
Example:
</p>
<code><small>
$link = mysql_connect('localhost','ellie','my_password');<br />
$db_selected = mysql_select_db('Northwind', $link);<br />
</small></code>
<h4>
Filename: dbselect.php
</h4>
<blockquote><small>
<div class="disp2">
<PRE>
<span class="syntax0"><span class="gutter">   1:</span><span class="syntax17">&lt;?php</span>
<span class="gutter">   2:</span>  <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">Opening</span><span class="syntax13"> </span><span class="syntax13">a</span><span class="syntax13"> </span><span class="syntax13">connection</span><span class="syntax13"> </span><span class="syntax13">to</span><span class="syntax13"> </span><span class="syntax13">the</span><span class="syntax13"> </span><span class="syntax13">MySQL</span><span class="syntax13"> </span><span class="syntax13">database</span><span class="syntax13"> </span><span class="syntax13">server&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">   3:</span>  <span class="syntax10">$</span><span class="syntax10">link</span> <span class="syntax18">=</span> <span class="syntax9">mysql_connect</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">localhost</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">djefferson</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">dino1234</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   4:</span>  <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span>
<span class="gutterH">   5:</span>    <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Connection</span><span class="syntax13"> </span><span class="syntax13">to</span><span class="syntax13"> </span><span class="syntax13">MySQL</span><span class="syntax13"> </span><span class="syntax13">server</span><span class="syntax13"> </span><span class="syntax13">failed!</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   6:</span>
<span class="gutter">   7:</span>  <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">Selecting</span><span class="syntax13"> </span><span class="syntax13">a</span><span class="syntax13"> </span><span class="syntax13">database</span><span class="syntax13"> </span><span class="syntax13">schema&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">   8:</span>  <span class="syntax10">$</span><span class="syntax10">selected</span> <span class="syntax18">=</span> <span class="syntax9">mysql_select_db</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Northwind</span><span class="syntax13">'</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   9:</span>  <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">selected</span><span class="syntax18">)</span>
<span class="gutterH">  10:</span>    <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Selection</span><span class="syntax13"> </span><span class="syntax13">of</span><span class="syntax13"> </span><span class="syntax13">the</span><span class="syntax13"> </span><span class="syntax13">MySQL</span><span class="syntax13"> </span><span class="syntax13">database</span><span class="syntax13"> </span><span class="syntax13">failed!</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>  
<span class="gutter">  11:</span>  <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">MySQL</span><span class="syntax13"> </span><span class="syntax13">database</span><span class="syntax13"> </span><span class="syntax13">selected</span><span class="syntax13"> </span><span class="syntax13">successfully&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  12:</span>
<span class="gutter">  13:</span>  <span class="syntax9">mysql_close</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  14:</span><span class="syntax17">?&gt;</span></span>
</PRE>
</div>
</small></blockquote>
<p>
First, we establish a connection to the MySQL database server; in this example
the connection is made to "localhost" using a valid username and password for
authentication.
</p><p>
Using the <b>mysql_select_db()</b> function, the "Northwind" database is set as
the default database. From now on, all the queries executed assume this database
schema as the default.
</p><p>
Because, once the connection is closed, the default database is also closed,
you will need to perform mysql_connect() and mysql_select_db() on every web page
needing this database connectivity.
</p><p>
If successful, mysql_select_db() returns the Boolean TRUE, otherwise it
returns FALSE.
</p><p>
Executing SQL Statements (INSERT, UPDATE, DELETE)
</p><p>
Once connected to the database server, and having selected a database,
it is time to start executing SQL commands.
</p><p>
PHP provides the <b>mysql_query()</b> function to perform database queries.
You must have the appropriate permissions to execute queries on a given database.
</p><p>
Format:
</p>
<code><small>
resource mysql_query ( string query [, resource link_identifier] )<br />
</small></code>
<p>
Example:
</p>
<code><small>
$result = mysql_query("SELECT CompanyName, Phone FROM Shippers");<br />
$result = mysql_query("DESCRIBE Shippers");<br />
</small></code>
<p>
For the SELECT, SHOW, DESCRIBE, or EXPLAIN statements, mysql_query() returns a
resource on success, or FALSE on error. For other types of SQL statements
(UPDATE, DELETE, DROP, etc.), mysql_query() returns TRUE on success or FALSE
on error.
</p><p>
PHP provides a number of functions to deal with the result, such as
<b>mysql_fetch_array()</b> , <b>mysql_num_rows()</b> , <b>mysql_affected_rows()</b>
, and so on.
</p><p>
You can also use the built-in error-handling functions to find out why a query
failed.
</p><p>
You can test that your SQL statement is valid by executing it in another MySQL
client, such as the mysql command line.
</p><p>
For INSERT, UPDATE, and DELETE, this function will return TRUE if the operation
was successful and FALSE otherwise.
</p>
<h4>
Filename: dbquery.php
</h4>
<blockquote><small>
<div class="disp2">
<PRE>
<span class="syntax0"><span class="gutter">   1:</span><span class="syntax17">&lt;html</span><span class="syntax17">&gt;</span>
<span class="gutter">   2:</span> <span class="syntax17">&lt;head</span><span class="syntax17">&gt;</span><span class="syntax17">&lt;title</span><span class="syntax17">&gt;</span>MySQL Queries in PHP<span class="syntax17">&lt;/title</span><span class="syntax17">&gt;</span><span class="syntax17">&lt;/head</span><span class="syntax17">&gt;</span>
<span class="gutter">   3:</span> <span class="syntax17">&lt;body</span><span class="syntax17"> </span><span class="syntax17">bgcolor</span><span class="syntax18">=</span><span class="syntax14">&quot;</span><span class="syntax14">lightblue</span><span class="syntax14">&quot;</span><span class="syntax17">&gt;</span>
<span class="gutter">   4:</span>  <span class="syntax17">&lt;font</span><span class="syntax17"> </span><span class="syntax17">size</span><span class="syntax18">=</span><span class="syntax13">'</span><span class="syntax13">+</span><span class="syntax13">1</span><span class="syntax13">'</span><span class="syntax17"> </span><span class="syntax17">face</span><span class="syntax18">=</span><span class="syntax13">'</span><span class="syntax13">arial</span><span class="syntax13">'</span><span class="syntax17">&gt;</span>
<span class="gutterH">   5:</span>  <span class="syntax17">&lt;?php</span>
<span class="gutter">   6:</span>    <span class="syntax8">print</span> <span class="syntax14">&quot;</span><span class="syntax14">Opening</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">connection</span><span class="syntax14"> </span><span class="syntax14">to</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">database</span><span class="syntax14"> </span><span class="syntax14">server</span><span class="syntax14">&lt;</span><span class="syntax14">br</span><span class="syntax14"> </span><span class="syntax14">/</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
<span class="gutter">   7:</span>    <span class="syntax10">$</span><span class="syntax10">link</span> <span class="syntax18">=</span> <span class="syntax9">mysql_connect</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">localhost</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">djefferson</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">dino1234</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   8:</span>    <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span>
<span class="gutter">   9:</span>      <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Connection</span><span class="syntax13"> </span><span class="syntax13">to</span><span class="syntax13"> </span><span class="syntax13">MySQL</span><span class="syntax13"> </span><span class="syntax13">server</span><span class="syntax13"> </span><span class="syntax13">failed!</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutterH">  10:</span>    <span class="syntax10">$</span><span class="syntax10">database</span> <span class="syntax18">=</span> <span class="syntax13">'</span><span class="syntax13">Northwind</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  11:</span>    <span class="syntax8">print</span> <span class="syntax14">&quot;</span><span class="syntax14">Selecting</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax10">$</span><span class="syntax10">database</span><span class="syntax14"> </span><span class="syntax14">database</span><span class="syntax14">&lt;</span><span class="syntax14">br</span><span class="syntax14"> </span><span class="syntax14">/</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
<span class="gutter">  12:</span>    <span class="syntax10">$</span><span class="syntax10">selected</span> <span class="syntax18">=</span> <span class="syntax9">mysql_select_db</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">database</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  13:</span>    <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">selected</span><span class="syntax18">)</span>
<span class="gutter">  14:</span>      <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Selection</span><span class="syntax13"> </span><span class="syntax13">of</span><span class="syntax13"> </span><span class="syntax13">database</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax10">$</span><span class="syntax10">database</span> <span class="syntax18">.</span><span class="syntax13">'</span><span class="syntax13"> </span><span class="syntax13">failed!</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutterH">  15:</span>
<span class="gutter">  16:</span>    <span class="syntax10">$</span><span class="syntax10">query</span> <span class="syntax18">=</span> <span class="syntax14">&quot;</span><span class="syntax14">UPDATE</span><span class="syntax14"> </span><span class="syntax14">Shippers</span><span class="syntax14"> </span><span class="syntax14">SET</span><span class="syntax14"> </span><span class="syntax14">phone</span><span class="syntax14"> </span><span class="syntax14">=</span><span class="syntax14"> </span><span class="syntax14">'</span><span class="syntax14">(</span><span class="syntax14">777</span><span class="syntax14">)</span><span class="syntax14"> </span><span class="syntax14">430</span><span class="syntax14">-</span><span class="syntax14">2346</span><span class="syntax14">'</span><span class="syntax14">&quot;</span>
<span class="gutter">  17:</span>            <span class="syntax18">.</span><span class="syntax14">&quot;</span><span class="syntax14"> </span><span class="syntax14">WHERE</span><span class="syntax14"> </span><span class="syntax14">CompanyName</span><span class="syntax14"> </span><span class="syntax14">=</span><span class="syntax14"> </span><span class="syntax14">'</span><span class="syntax14">Federal</span><span class="syntax14"> </span><span class="syntax14">Shipping</span><span class="syntax14">'</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
<span class="gutter">  18:</span>    <span class="syntax10">$</span><span class="syntax10">result</span> <span class="syntax18">=</span> <span class="syntax9">mysql_query</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">query</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  19:</span>    <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">result</span><span class="syntax18">)</span>
<span class="gutterH">  20:</span>      <span class="syntax8">die</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Query</span><span class="syntax13"> </span><span class="syntax13">failed:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  21:</span>
<span class="gutter">  22:</span>    <span class="syntax2">//</span><span class="syntax2"> </span><span class="syntax2">number</span><span class="syntax2"> </span><span class="syntax2">of</span><span class="syntax2"> </span><span class="syntax2">rows</span><span class="syntax2"> </span><span class="syntax2">affected</span><span class="syntax2"> </span><span class="syntax2">by</span><span class="syntax2"> </span><span class="syntax2">the</span><span class="syntax2"> </span><span class="syntax2">most</span><span class="syntax2"> </span><span class="syntax2">recently</span><span class="syntax2"> </span><span class="syntax2">executed</span><span class="syntax2"> </span><span class="syntax2">query</span>
<span class="gutter">  23:</span>    <span class="syntax10">$</span><span class="syntax10">rows_affected</span> <span class="syntax18">=</span> <span class="syntax9">mysql_affected_rows</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span><span class="syntax18">;</span> 
<span class="gutter">  24:</span>    <span class="syntax8">echo</span> <span class="syntax14">&quot;</span><span class="syntax14">You</span><span class="syntax14"> </span><span class="syntax14">have</span><span class="syntax14"> </span><span class="syntax14">updated</span><span class="syntax14"> </span><span class="syntax10">$</span><span class="syntax10">rows_affected</span><span class="syntax14"> </span><span class="syntax14">row</span><span class="syntax14">(</span><span class="syntax14">s</span><span class="syntax14">)</span><span class="syntax14">.</span><span class="syntax14">&lt;</span><span class="syntax14">br</span><span class="syntax14"> </span><span class="syntax14">/</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
<span class="gutterH">  25:</span>
<span class="gutter">  26:</span>    <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">Closing</span><span class="syntax13"> </span><span class="syntax13">the</span><span class="syntax13"> </span><span class="syntax13">connection&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  27:</span>    <span class="syntax9">mysql_close</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  28:</span>  <span class="syntax17">?&gt;</span>
<span class="gutter">  29:</span>  <span class="syntax17">&lt;/font</span><span class="syntax17">&gt;</span>
<span class="gutterH">  30:</span> <span class="syntax17">&lt;/body</span><span class="syntax17">&gt;</span>
<span class="gutter">  31:</span><span class="syntax17">&lt;/html</span><span class="syntax17">&gt;</span></span>
</PRE>
</div>
</small></blockquote>
<p>
First, we connect to the database server. Then, the "Northwind" practice
database is selected.
</p><p>
The SQL statement is created on lines 16-17. It is assigned to the variable
$query.
</p><p>
Notice that the SQL string is just like any other SQL statement you
would type in the MySQL Query Browser or at the mysql command line.
</p><p>
It can also contain explicit values or variables evaluated by PHP before
sending the query to the database.
</p><p>
The <b>mysql_query()</b> function is executed on line 18 and will return TRUE
if the query is successful and FALSE if not.

</p><p>
If the query is successful, the database will be updated. If not, the PHP script
will die (exit) with the message: "Query failed:" followed by the reason for
the error.
</p><p>
The <b>mysql_error()</b> function returns a message that tells us what was wrong
with the query, similar to the message you would receive at the MySQL console.
</p><p>
The <b>mysql_affected_rows()</b> function returns the number of affected rows
from the previous MySQL query.
</p></li>
<li><p>
Retrieving the Query Results (SELECT)
</p><p>
The SQL commands INSERT, UPDATE, and DELETE do not return any data as shown
in the previous examples, whereas the SELECT statement normally returns a set
of data records, called the result set.
</p><p>
The format for the mysql_query() function does not change, but a result set
is returned if the query is successful, and FALSE is returned if the query fails.
</p><p>
Format:
</p>
<code><small>
resource mysql_query ( string query [, resource link_identifier] )<br>
</small></code>
<p>
Example:
</p>
<code><small>
$result = mysql_query("SELECT subject, body FROM messages");<br>
</small></code>
</p><p>
Many rows of data might be returned to the result set as the result of the SQL
execution. If this function fails to execute the SQL statement, it will return
FALSE instead of the result set.
</p><p>
To display the result set, PHP has provided a number of functions including
<b>mysql_result()</b> , <b>mysql_fetch_array()</b> , and <b>mysql_fetch_row()</b> .
</p></li>
<li><p>
The mysql_fetch_row() Function
</p><p>
The <b>mysql_fetch_row()</b> function is used to extract one record of the data
from the result set.
</p><p>
Format:
</p>
<blockquote><code><small>
array mysql_fetch_row ( resource result )<br>
</small></code></blockquote>
<p>
Example:
</p>
<blockquote><code><small>
$result_set = mysql_query($query_string)<br>
$record = mysql_fetch_row( $result_set );<br>
</small></code></blockquote>
<p>
The $result variable is assigned the value returned from mysql_query()
function, a numeric array.
</p><p>
Although the result set might contain many records, the value returned from
the mysql_fetch_row() function is only the first row.
</p><p>
Each successive call to the mysql_fetch_row() function returns the next record
(by moving an internal pointer) until there are no more records.
</p>
<h4>
Filename: dbfetch.php
</h4>
<blockquote><small>
<div class="disp2">
<PRE>
<span class="syntax0"><span class="gutter">   1:</span><span class="syntax17">&lt;html</span><span class="syntax17">&gt;</span>
<span class="gutter">   2:</span> <span class="syntax17">&lt;head</span><span class="syntax17">&gt;</span><span class="syntax17">&lt;title</span><span class="syntax17">&gt;</span>MySQL Fetch a Row<span class="syntax17">&lt;/title</span><span class="syntax17">&gt;</span><span class="syntax17">&lt;/head</span><span class="syntax17">&gt;</span>
<span class="gutter">   3:</span> <span class="syntax17">&lt;body</span><span class="syntax17"> </span><span class="syntax17">bgcolor</span><span class="syntax18">=</span><span class="syntax14">&quot;</span><span class="syntax14">lightblue</span><span class="syntax14">&quot;</span><span class="syntax17">&gt;</span>
<span class="gutter">   4:</span>  <span class="syntax17">&lt;font</span><span class="syntax17"> </span><span class="syntax17">size</span><span class="syntax18">=</span><span class="syntax13">'</span><span class="syntax13">+</span><span class="syntax13">1</span><span class="syntax13">'</span><span class="syntax17"> </span><span class="syntax17">face</span><span class="syntax18">=</span><span class="syntax13">'</span><span class="syntax13">arial</span><span class="syntax13">'</span><span class="syntax17">&gt;</span>
<span class="gutterH">   5:</span>  <span class="syntax17">&lt;?php</span>
<span class="gutter">   6:</span>    <span class="syntax8">print</span> <span class="syntax14">&quot;</span><span class="syntax14">Opening</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">connection</span><span class="syntax14"> </span><span class="syntax14">to</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">database</span><span class="syntax14"> </span><span class="syntax14">server</span><span class="syntax14">&lt;</span><span class="syntax14">br</span><span class="syntax14"> </span><span class="syntax14">/</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
<span class="gutter">   7:</span>    <span class="syntax10">$</span><span class="syntax10">link</span> <span class="syntax18">=</span> <span class="syntax9">mysql_connect</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">localhost</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">djefferson</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">dino1234</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   8:</span>    <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span>
<span class="gutter">   9:</span>      <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Connection</span><span class="syntax13"> </span><span class="syntax13">to</span><span class="syntax13"> </span><span class="syntax13">MySQL</span><span class="syntax13"> </span><span class="syntax13">server</span><span class="syntax13"> </span><span class="syntax13">failed!</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutterH">  10:</span>    <span class="syntax10">$</span><span class="syntax10">database</span> <span class="syntax18">=</span> <span class="syntax13">'</span><span class="syntax13">Northwind</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  11:</span>    <span class="syntax8">print</span> <span class="syntax14">&quot;</span><span class="syntax14">Selecting</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax10">$</span><span class="syntax10">database</span><span class="syntax14"> </span><span class="syntax14">database</span><span class="syntax14">&lt;</span><span class="syntax14">br</span><span class="syntax14"> </span><span class="syntax14">/</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
<span class="gutter">  12:</span>    <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span> <span class="syntax9">mysql_select_db</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">database</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span><span class="syntax18">)</span>
<span class="gutter">  13:</span>      <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Selection</span><span class="syntax13"> </span><span class="syntax13">of</span><span class="syntax13"> </span><span class="syntax13">database</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax10">$</span><span class="syntax10">database</span> <span class="syntax18">.</span><span class="syntax13">'</span><span class="syntax13"> </span><span class="syntax13">failed!</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  14:</span>
<span class="gutterH">  15:</span>    <span class="syntax10">$</span><span class="syntax10">query</span> <span class="syntax18">=</span> <span class="syntax13">'</span><span class="syntax13">SELECT</span><span class="syntax13"> </span><span class="syntax13">CompanyName,</span><span class="syntax13"> </span><span class="syntax13">Phone</span><span class="syntax13"> </span><span class="syntax13">from</span><span class="syntax13"> </span><span class="syntax13">Shippers</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  16:</span>    <span class="syntax10">$</span><span class="syntax10">result</span> <span class="syntax18">=</span> <span class="syntax9">mysql_query</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">query</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  17:</span>    <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">result</span><span class="syntax18">)</span>
<span class="gutter">  18:</span>      <span class="syntax8">die</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Query</span><span class="syntax13"> </span><span class="syntax13">failed:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  19:</span>
<span class="gutterH">  20:</span>    <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">Fetch</span><span class="syntax13"> </span><span class="syntax13">the</span><span class="syntax13"> </span><span class="syntax13">first</span><span class="syntax13"> </span><span class="syntax13">row</span><span class="syntax13"> </span><span class="syntax13">of</span><span class="syntax13"> </span><span class="syntax13">data.&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  21:</span>    <span class="syntax10">$</span><span class="syntax10">record</span> <span class="syntax18">=</span> <span class="syntax9">mysql_fetch_row</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">result</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  22:</span>    <span class="syntax2">//</span><span class="syntax2"> </span><span class="syntax2">print_r($record);</span>
<span class="gutter">  23:</span>    <span class="syntax8">foreach</span><span class="syntax18"> (</span><span class="syntax10">$</span><span class="syntax10">record</span> <span class="syntax8">as</span> <span class="syntax10">$</span><span class="syntax10">value</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">  24:</span>      <span class="syntax8">print</span> <span class="syntax14">&quot;</span><span class="syntax14">&lt;</span><span class="syntax14">em</span><span class="syntax14">&gt;</span><span class="syntax10">$</span><span class="syntax10">value</span><span class="syntax14"> </span><span class="syntax14">&lt;</span><span class="syntax14">/</span><span class="syntax14">em</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span> <span class="syntax2">//</span><span class="syntax2"> </span><span class="syntax2">print</span><span class="syntax2"> </span><span class="syntax2">the</span><span class="syntax2"> </span><span class="syntax2">row</span>
<span class="gutterH">  25:</span>    <span class="syntax18">}</span>
<span class="gutter">  26:</span>    <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  27:</span>
<span class="gutter">  28:</span>    <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">Closing</span><span class="syntax13"> </span><span class="syntax13">the</span><span class="syntax13"> </span><span class="syntax13">connection&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  29:</span>    <span class="syntax9">mysql_close</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutterH">  30:</span>  <span class="syntax17">?&gt;</span>
<span class="gutter">  31:</span>  <span class="syntax17">&lt;/font</span><span class="syntax17">&gt;</span>
<span class="gutter">  32:</span> <span class="syntax17">&lt;/body</span><span class="syntax17">&gt;</span>
<span class="gutter">  33:</span><span class="syntax17">&lt;/html</span><span class="syntax17">&gt;</span></span>
</PRE>
</div>
</small></blockquote>
<p>
A connection is made to the database server on line 7. Notice that we have to do
this on every single web page that needs the database connection because the
connection is implicitly closed at the end of the script.
</p><p>
Next, the database is selected on line 12. Server connection and database selection
are required at the beginning of all database-enabled pages. Alternatively,
you could put these statements in a script that will be included on every page
using the <b>include()</b> or <b>require()</b> functions.
</p><p>
The mysql_query() function executes the query and the result is assigned to the
$result variable.
</p><p>
One record is fetched from the result set by <b>mysql_fetch_row()</b> on line 21.
</p><p>
The function keeps an internal counter of what records have been fetched so that
the next call to mysql_fetch_row() returns the next record in the set, until
there are no more.
</p><p>
The foreach loop is used to list the contents of the array that was returned
by mysql_fetch_row().
</p></li>
<li><p>
The mysql_fetch_assoc() Function
</p><p>
In the previous example we fetched a record from the record set and the record
returned was a numerically indexed array.
</p><p>
However, PHP also supports associative arrays, which are sometimes much easier
to use. So naturally, a result set can also be processed as an associative array.
</p><p>
The <b>mysql_fetch_assoc()</b> function is very similar to mysql_fetch_row()
except that the result returned is an associative array.
</p><p>
Format:
</p>
<blockquote><code><small>
array mysql_fetch_assoc ( resource result )<br>
</small></code></blockquote>
<p>
Example:
</p>
<blockquote><code><small>
$record = mysql_fetch_assoc($result)<br>
</small></code></blockquote>
</p><p>
In this example, the $result variable contains what was returned from the
mysql_query() function, and $record is the current row from that record set
returned as an associative array.
</p>
<h4>
Filename: dbfetchAssoc.php
</h4>
<blockquote><small>
<div class="disp2">
<PRE>
<span class="syntax0"><span class="gutter">   1:</span><span class="syntax17">&lt;html</span><span class="syntax17">&gt;</span>
<span class="gutter">   2:</span> <span class="syntax17">&lt;head</span><span class="syntax17">&gt;</span>
<span class="gutter">   3:</span>  <span class="syntax17">&lt;title</span><span class="syntax17">&gt;</span>MySQL Fetch Associative Array<span class="syntax17">&lt;/title</span><span class="syntax17">&gt;</span>
<span class="gutter">   4:</span> <span class="syntax17">&lt;/head</span><span class="syntax17">&gt;</span>
<span class="gutterH">   5:</span> <span class="syntax17">&lt;body</span><span class="syntax17"> </span><span class="syntax17">bgcolor</span><span class="syntax18">=</span><span class="syntax14">&quot;</span><span class="syntax14">lightblue</span><span class="syntax14">&quot;</span><span class="syntax17">&gt;</span>
<span class="gutter">   6:</span>  <span class="syntax17">&lt;font</span><span class="syntax17"> </span><span class="syntax17">size</span><span class="syntax18">=</span><span class="syntax13">'</span><span class="syntax13">+</span><span class="syntax13">1</span><span class="syntax13">'</span><span class="syntax17"> </span><span class="syntax17">face</span><span class="syntax18">=</span><span class="syntax13">'</span><span class="syntax13">arial</span><span class="syntax13">'</span><span class="syntax17">&gt;</span>
<span class="gutter">   7:</span>  <span class="syntax17">&lt;?php</span>
<span class="gutter">   8:</span>    <span class="syntax8">print</span> <span class="syntax14">&quot;</span><span class="syntax14">Opening</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">connection</span><span class="syntax14"> </span><span class="syntax14">to</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">database</span><span class="syntax14"> </span><span class="syntax14">server</span><span class="syntax14">&lt;</span><span class="syntax14">br</span><span class="syntax14"> </span><span class="syntax14">/</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
<span class="gutter">   9:</span>    <span class="syntax10">$</span><span class="syntax10">link</span> <span class="syntax18">=</span> <span class="syntax9">mysql_connect</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">localhost</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">djefferson</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">dino1234</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutterH">  10:</span>    <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span>
<span class="gutter">  11:</span>      <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Connection</span><span class="syntax13"> </span><span class="syntax13">to</span><span class="syntax13"> </span><span class="syntax13">MySQL</span><span class="syntax13"> </span><span class="syntax13">server</span><span class="syntax13"> </span><span class="syntax13">failed!</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  12:</span>    <span class="syntax10">$</span><span class="syntax10">database</span> <span class="syntax18">=</span> <span class="syntax13">'</span><span class="syntax13">Northwind</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  13:</span>    <span class="syntax8">print</span> <span class="syntax14">&quot;</span><span class="syntax14">Selecting</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax10">$</span><span class="syntax10">database</span><span class="syntax14"> </span><span class="syntax14">database</span><span class="syntax14">&lt;</span><span class="syntax14">br</span><span class="syntax14"> </span><span class="syntax14">/</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
<span class="gutter">  14:</span>    <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span> <span class="syntax9">mysql_select_db</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">database</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span><span class="syntax18">)</span>
<span class="gutterH">  15:</span>      <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Selection</span><span class="syntax13"> </span><span class="syntax13">of</span><span class="syntax13"> </span><span class="syntax13">database</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax10">$</span><span class="syntax10">database</span> <span class="syntax18">.</span><span class="syntax13">'</span><span class="syntax13"> </span><span class="syntax13">failed!</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  16:</span>
<span class="gutter">  17:</span>    <span class="syntax10">$</span><span class="syntax10">query</span> <span class="syntax18">=</span> <span class="syntax13">'</span><span class="syntax13">SELECT</span><span class="syntax13"> </span><span class="syntax13">CompanyName,</span><span class="syntax13"> </span><span class="syntax13">Phone</span><span class="syntax13"> </span><span class="syntax13">from</span><span class="syntax13"> </span><span class="syntax13">Shippers</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  18:</span>    <span class="syntax10">$</span><span class="syntax10">result</span> <span class="syntax18">=</span> <span class="syntax9">mysql_query</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">query</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  19:</span>    <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">result</span><span class="syntax18">)</span>
<span class="gutterH">  20:</span>      <span class="syntax8">die</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Query</span><span class="syntax13"> </span><span class="syntax13">failed:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  21:</span>
<span class="gutter">  22:</span>    <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">Fetch</span><span class="syntax13"> </span><span class="syntax13">the</span><span class="syntax13"> </span><span class="syntax13">first</span><span class="syntax13"> </span><span class="syntax13">row</span><span class="syntax13"> </span><span class="syntax13">of</span><span class="syntax13"> </span><span class="syntax13">data.&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  23:</span>    <span class="syntax10">$</span><span class="syntax10">record</span> <span class="syntax18">=</span> <span class="syntax9">mysql_fetch_assoc</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">result</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  24:</span>    <span class="syntax8">foreach</span><span class="syntax18"> (</span><span class="syntax10">$</span><span class="syntax10">record</span> <span class="syntax8">as</span> <span class="syntax10">$</span><span class="syntax10">key</span> <span class="syntax18">=</span><span class="syntax18">&gt;</span> <span class="syntax10">$</span><span class="syntax10">value</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutterH">  25:</span>      <span class="syntax8">print</span> <span class="syntax14">&quot;</span><span class="syntax14">&lt;</span><span class="syntax14">em</span><span class="syntax14">&gt;</span><span class="syntax10">$</span><span class="syntax10">key</span><span class="syntax14">:</span><span class="syntax14"> </span><span class="syntax10">$</span><span class="syntax10">value</span><span class="syntax14">&lt;</span><span class="syntax14">/</span><span class="syntax14">em</span><span class="syntax14">&gt;</span><span class="syntax14">&lt;</span><span class="syntax14">br</span><span class="syntax14"> </span><span class="syntax14">/</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span> <span class="syntax2">//</span><span class="syntax2"> </span><span class="syntax2">Print</span><span class="syntax2"> </span><span class="syntax2">the</span><span class="syntax2"> </span><span class="syntax2">row</span>
<span class="gutter">  26:</span>    <span class="syntax18">}</span>
<span class="gutter">  27:</span>    <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  28:</span>
<span class="gutter">  29:</span>    <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">Closing</span><span class="syntax13"> </span><span class="syntax13">the</span><span class="syntax13"> </span><span class="syntax13">connection&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutterH">  30:</span>    <span class="syntax9">mysql_close</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">link</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  31:</span>  <span class="syntax17">?&gt;</span>
<span class="gutter">  32:</span>  <span class="syntax17">&lt;/font</span><span class="syntax17">&gt;</span>
<span class="gutter">  33:</span> <span class="syntax17">&lt;/body</span><span class="syntax17">&gt;</span>
<span class="gutter">  34:</span><span class="syntax17">&lt;/html</span><span class="syntax17">&gt;</span></span>
</PRE>
</div>
</small></blockquote>
<p>
The MySQL server connection is made, and the "Northwind" database is selected.
</p><p>
The SQL SELECT statement string is assigned to the variable, $query.
</p><p>
After mysql_query() is executed the result set contains the results returned
from the database query.
</p><p>
Instead of using mysql_fetch_row() and getting an array indexed by numbers,
the <b>mysql_fetch_assoc()</b> function returns an associative array with the
index being the name of the column specified in the database, and its value
what is found in that column for the current row.
</p><p>
The foreach loop is used to iterate through the associative array, to retrieve
both the keys (column names) and the value associated with each of them.
</p>
</li>
</ul>
</div>
</body>
</html>
