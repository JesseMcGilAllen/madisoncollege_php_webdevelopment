<!DOCTYPE html PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html>
<head>
<meta name="generator" content="HTML Tidy, see www.w3.org">
<title>MySQL Functions</title>
<link href="../../../css/basic.css" rel="stylesheet" type="text/css">
<script type="text/javascript" language="JavaScript">
<!--
function putSemester() {
    var today=new Date();
    var thisMonth=today.getMonth()+1;
    var thisYear=today.getFullYear();
    if(thisMonth <=6) {
        return "Spring, " + thisYear;
    }
    else {
       return "Fall, " + thisYear;
    }
}//-->
</script>
<style type="text/css">
<!--
    .bgStripes {
        background-image:url(../../../images/Xstripes.gif);
        background-attachment: fixed;
    }
    body {
        background-color:white;
    }
    strong {
        font-family: Arial, Helvetica, sans-serif;
    }
-->
</style>
</head>
<body style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<table class="bgStripes" border="0" width="100%">
<tbody>
<tr name="firstRow">
<td valign="top" width="80"><span style="font-size: x-small; font-weight: bold;">
<script type="text/javascript">
<!--
    document.write(putSemester());
-->
</script>
</span> <br />
</td>
<td style="text-align: center;"><span style="font-weight: bold; font-size: medium; color: darkblue;">
PHP Web Development with MySQL
</span> </td>
<td align="right" valign="top" width="80"><span style="font-size: x-small; font-weight: bold;">
3 Credits</span> </td>
</tr>
<tr>
<td colspan="3" style="text-align: center;"><span style="font-size: xx-small; font-weight: bold;">
152-166</span> </td>
</tr>
</tbody>
</table>
<!--The heading for the slides --> <br />
<table class="headTable1" border="0">
<tbody>
<tr>
<td width="100"><a href="phpmysql1.html"><img alt="" src="../../../images/btn_lArrow.gif" border="0"></a><a href="index.html"><img alt="" src="../../../images/btn_upArrow.gif" border="0"></a><a href="index.html"><img alt="" src="../../../images/btn_rArrow.gif" border="0"></a></td>
<td>Using the MySQL Function Library</td>
</tr>
</tbody>
</table>
<br />
<div class="disp1">
<ul class="slidesUl1">
<li><p>
Some Useful MySQL Functions
</p><p>
PHP comes with a number of built-in MySQL functions. In this section we look at
some commonly used ones.
</p><p>
The table below lists some of the MySQL functions you might find useful when integrating PHP and MySQL.
</p><p>
Table: Some Useful MySQL Functions
</p>
<table>
<tr>
<td><code><b><u>
Database Function</u></b></code></td>
<td><code><b><u>
What It Does</u></b></code></td>
</tr><tr>
<td><code>
mysql_connect()</code></td>
<td><code>
Opens a connection to a MySQL server.</code></td>
</tr><tr>
<td><code>
mysql_pconnect()</code></td>
<td><code>
Opens a persistent connection.</code></td>
</tr><tr>
<td><code>
mysql_selectdb()</code></td>
<td><code>
Selects the default database.</code></td>
</tr><tr>
<td><code>
mysql_change_user()</code></td>
<td><code>
Changes the identity of the user logged on.</code></td>
</tr><tr>
<td><code>
mysql_list_dbs</code></td>
<td><code>
Lists databases for this MySQL server.</code></td>
</tr><tr>
<td><code>
mysql_list_tables</code></td>
<td><code>
Lists tables in the database.</code></td>
</tr><tr>
<td><code><b><i>
Query Functions Affecting Rows</i></b></code></td>
</tr><tr>
<td><code>
mysql_fetch_assoc()</code></td>
<td><code>
Returns one result row, as an associative array.</code></td>
</tr><tr>
<td><code>
mysql_fetch_row()</code></td>
<td><code>
Returns one result row, as an array.</code></td>
</tr><tr>
<td><code>
mysql_affected_rows()</code></td>
<td><code>
Returns number of rows affected by query.</code></td>
</tr><tr>
<td><code>
mysql_num_rows()</code></td>
<td><code>
Returns number of rows selected.</code></td>
</tr><tr>
<td><code>
mysql_fetch_object()</code></td>
<td><code>
Returns a result row, as an object.</code></td>
</tr><tr>
<td><code><b><i>
Query Functions Affecting Columns</i></b></code></td>
</tr><tr>
<td><code>
mysql_fetch_field()</code></td>
<td><code>
Gets column information from a result and returns as an object.</code></td>
</tr><tr>
<td><code>
mysql_field_name()</code></td>
<td><code>
Gets the name of the specified field in a result.</code></td>
</tr><tr>
<td><code>
mysql_list_fields()</code></td>
<td><code>
Sets result pointer to a specified field offset.</code></td>
</tr><tr>
<td><code>
mysql_num_fields()</code></td>
<td><code>
Gets number of fields in a result.</code></td>
</tr><tr>
<td><code>
mysql_field_seek()</code></td>
<td><code>
Sets result pointer to a specified field offset.</code></td>
</tr><tr>
<td><code>
mysql_field_type()</code></td>
<td><code>
Gets the type of the specified field in a result.</code></td>
</tr><tr>
<td><code>
mysql_field_len()</code></td>
<td><code>
Returns the length of the specified field.</code></td>
</tr><tr>
<td><code>
mysql_field_table()</code></td>
<td><code>
Gets name of the table the specified field is in.</code></td>
</tr><tr>
<td><code>
mysql_tablename()</code></td>
<td><code>
Gets table name of field.</code></td>
</tr><tr>
<td><code><b><i>
Functions for Error Handling</i></b></code></td>
</tr><tr>
<td><code>
mysql_errno()</code></td>
<td><code>
Returns the numerical value of the error message from previous MySQL operation.</code></td>
</tr><tr>
<td><code>
mysql_error()</code></td>
<td><code>
Returns the text of the error message from previous MySQL operation.</code></td>
</tr>
</table>
</li>
<li><p>
The mysql_error() Function
</p><p>
The execution of a database function might fail for a variety of reasons.
Perhaps the database server is down, or the network connection is unavailable,
or simply the username and password used to connect are not authorized to access
the database.
</p><p>
The <b>mysql_error()</b> function returns the text of the error message
generated by the MySQL server.
</p><p>
If there were error messages generated by multiple MySQL calls, this function
returns the most common error message.
</p><p>
Format:
</p>
<blockquote><code>
$error_message mysql_error()<br />
</code></blockquote>
<p>
In the preceding format, <b>$error_message</b> is the text of the error message
returned from the database server.
</p>
<h4>
Filename: dberror.php
</h4>
<blockquote><small>
<div class="disp2">
<PRE>
<span class="syntax0"><span class="gutter">   1:</span><span class="syntax17">&lt;?php</span>
<span class="gutter">   2:</span>  <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">Opening</span><span class="syntax13"> </span><span class="syntax13">the</span><span class="syntax13"> </span><span class="syntax13">connection</span><span class="syntax13"> </span><span class="syntax13">to</span><span class="syntax13"> </span><span class="syntax13">the</span><span class="syntax13"> </span><span class="syntax13">database</span><span class="syntax13"> </span><span class="syntax13">server&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">   3:</span>  <span class="syntax18">@</span> <span class="syntax10">$</span><span class="syntax10">db</span> <span class="syntax18">=</span> <span class="syntax9">mysql_connect</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">localhost</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">djefferson</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">dino1234</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   4:</span>  <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutterH">   5:</span>    <span class="syntax10">$</span><span class="syntax10">error_message</span> <span class="syntax18">=</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   6:</span>    <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">There</span><span class="syntax13"> </span><span class="syntax13">was</span><span class="syntax13"> </span><span class="syntax13">a</span><span class="syntax13"> </span><span class="syntax13">problem</span><span class="syntax13"> </span><span class="syntax13">connecting</span><span class="syntax13"> </span><span class="syntax13">to</span><span class="syntax13"> </span><span class="syntax13">the</span><span class="syntax13"> </span><span class="syntax13">MySQL</span><span class="syntax13"> </span><span class="syntax13">server:&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">   7:</span>    <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">error_message</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   8:</span>  <span class="syntax18">}</span>
<span class="gutter">   9:</span>  <span class="syntax8">print</span> <span class="syntax14">&quot;</span><span class="syntax14">Connection</span><span class="syntax14"> </span><span class="syntax14">to</span><span class="syntax14"> </span><span class="syntax14">MySQL</span><span class="syntax14"> </span><span class="syntax14">successful</span><span class="syntax14">&lt;</span><span class="syntax14">br</span><span class="syntax14"> </span><span class="syntax14">/</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
<span class="gutterH">  10:</span>  
<span class="gutter">  11:</span>  <span class="syntax10">$</span><span class="syntax10">database</span> <span class="syntax18">=</span> <span class="syntax13">'</span><span class="syntax13">Northwind</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  12:</span>  <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">Selecting</span><span class="syntax13"> </span><span class="syntax13">database</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax10">$</span><span class="syntax10">database</span> <span class="syntax18">.</span><span class="syntax13">'</span><span class="syntax13">&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  13:</span>  <span class="syntax10">$</span><span class="syntax10">selected</span> <span class="syntax18">=</span> <span class="syntax9">mysql_select_db</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">database</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  14:</span>  <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">selected</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutterH">  15:</span>    <span class="syntax10">$</span><span class="syntax10">error_message</span> <span class="syntax18">=</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  16:</span>    <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">There</span><span class="syntax13"> </span><span class="syntax13">was</span><span class="syntax13"> </span><span class="syntax13">a</span><span class="syntax13"> </span><span class="syntax13">problem</span><span class="syntax13"> </span><span class="syntax13">selecting</span><span class="syntax13"> </span><span class="syntax13">database</span><span class="syntax13"> </span><span class="syntax13">'</span>
<span class="gutter">  17:</span>         <span class="syntax18">.</span> <span class="syntax10">$</span><span class="syntax10">database</span> <span class="syntax18">.</span><span class="syntax13">'</span><span class="syntax13">:&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  18:</span>    <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">error_message</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  19:</span>  <span class="syntax18">}</span>
<span class="gutterH">  20:</span>  <span class="syntax8">print</span> <span class="syntax14">&quot;</span><span class="syntax14">Database</span><span class="syntax14"> </span><span class="syntax10">$</span><span class="syntax10">database</span><span class="syntax14"> </span><span class="syntax14">selected</span><span class="syntax14"> </span><span class="syntax14">successfully</span><span class="syntax14">&lt;</span><span class="syntax14">br</span><span class="syntax14"> </span><span class="syntax14">/</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
<span class="gutter">  21:</span><span class="syntax17">?&gt;</span></span>
</PRE>
</div>
</small></blockquote>
<p>
The user <b>djefferson</b> attempts to connect to the database server. The "@"
character is used to suppress printing of a PHP error message immediately upon
failure of the mysql_connect() function.
</p><p>
The resource variable $db will be empty if the connection failed, and an error
message will be printed, including the output of the <b>mysql_error()</b> function.
</p><p>
The database <b>Northwind</b> is selected. We assume that this database is
available and that we have access to it.
</p><p>
We check the value of the $selected variable. It will be empty if connection to
the database server failed.
</p><p>
If database selection fails, the mysql_error() function is called.
It will return a text message from the database server explaining the problem.
</p></li>
<li><p>
The mysql_num_rows() Function
</p><p>
The <b>mysql_num_rows()</b> function returns the number of rows in the result set.
</p><p>
Format:
</p>
<blockquote><code>
int mysql_num_rows( resource result )<br />
</code></blockquote>
<p>
Example:
</p>
<blockquote><code><small>
$number_of_rows = mysql_num_rows($result_set)<br />
</small></code></blockquote>
</p><p>
In the preceding example <b>$result_set</b> is what you got back from executing
the SELECT query, and <b>$number_of_rows</b> is the number of rows that were retrieved.
</p>
<h4>
Filename: numRows.php
</h4>
<blockquote><small>
<div class="disp2">
<PRE>
<span class="syntax0"><span class="gutter">   1:</span><span class="syntax17">&lt;?php</span>
<span class="gutter">   2:</span>  <span class="syntax18">@</span> <span class="syntax10">$</span><span class="syntax10">db</span> <span class="syntax18">=</span> <span class="syntax9">mysql_connect</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">localhost</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">djefferson</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">dino1234</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   3:</span>  <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">   4:</span>    <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Connection</span><span class="syntax13"> </span><span class="syntax13">to</span><span class="syntax13"> </span><span class="syntax13">server</span><span class="syntax13"> </span><span class="syntax13">failed:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutterH">   5:</span>  <span class="syntax18">}</span>
<span class="gutter">   6:</span>  <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span> <span class="syntax9">mysql_select_db</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Northwind</span><span class="syntax13">'</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">   7:</span>    <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Database</span><span class="syntax13"> </span><span class="syntax13">select</span><span class="syntax13"> </span><span class="syntax13">error:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   8:</span>  <span class="syntax18">}</span> 
<span class="gutter">   9:</span>  
<span class="gutterH">  10:</span>  <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">Executing</span><span class="syntax13"> </span><span class="syntax13">SQL...&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  11:</span>  <span class="syntax10">$</span><span class="syntax10">result</span> <span class="syntax18">=</span> <span class="syntax9">mysql_query</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">SELECT</span><span class="syntax13"> </span><span class="syntax13">ShipName</span><span class="syntax13"> </span><span class="syntax13">FROM</span><span class="syntax13"> </span><span class="syntax13">Orders</span><span class="syntax13">'</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  12:</span>  <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">result</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">  13:</span>    <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Database</span><span class="syntax13"> </span><span class="syntax13">query</span><span class="syntax13"> </span><span class="syntax13">error:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  14:</span>  <span class="syntax18">}</span>
<span class="gutterH">  15:</span>  <span class="syntax10">$</span><span class="syntax10">num_rows</span> <span class="syntax18">=</span> <span class="syntax9">mysql_num_rows</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">result</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  16:</span>  <span class="syntax8">print</span> <span class="syntax14">&quot;</span><span class="syntax14">&lt;</span><span class="syntax14">b</span><span class="syntax14">&gt;</span><span class="syntax14">There</span><span class="syntax14"> </span><span class="syntax14">are</span><span class="syntax14"> </span><span class="syntax14">a</span><span class="syntax14"> </span><span class="syntax14">total</span><span class="syntax14"> </span><span class="syntax14">of</span><span class="syntax14"> </span><span class="syntax10">$</span><span class="syntax10">num_rows</span><span class="syntax14"> </span><span class="syntax14">ship</span><span class="syntax14"> </span><span class="syntax14">names</span><span class="syntax14"> </span><span class="syntax14">&quot;</span>
<span class="gutter">  17:</span>       <span class="syntax18">.</span><span class="syntax13">'</span><span class="syntax13">in</span><span class="syntax13"> </span><span class="syntax13">the</span><span class="syntax13"> </span><span class="syntax13">&quot;Orders&quot;</span><span class="syntax13"> </span><span class="syntax13">table.</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  18:</span><span class="syntax17">?&gt;</span></span>
</PRE>
</div>
</small></blockquote>
<p>
After connecting to the database server and selecting the database, the SELECT
statement is executed using the <b>mysql_query()</b> function.
</p><p>
The variable, $result, will contain all the rows selected from the "Orders" table.
</p><p>
The <b>mysql_num_rows()</b> function will return the number of rows in the
record set.
</p></li>
<li><p>
The mysql_num_fields() Function
</p><p>
The <b>mysql_num_fields()</b> function returns the number of fields in a table
and the <b>mysql_field_name()</b> function returns the name of a field.
</p><p>
Format:
</p>
<blockquote><code>
int mysql_num_fields( resource result )<br />
</code></blockquote>
<p>
Example:
</p>
<blockquote><code><small>
$number_of_fields = mysql_num_fields($result_set)<br />
</small></code></blockquote>
<p>
In the preceding example, the $result_set variable contains the records retrieved
with the SELECT query and $number_of_fields contains the total number of columns
in that result set.
</p></li>
<li><p>
The mysql_field_name() Function
</p><p>
The mysql_field_name() function returns the name of a specific field.
</p><p>
Format:
</p>
<blockquote><code><small>
string mysql_field_name( resource result, int field_offset )<br />
</small></code></blockquote>
</p><p>
Example:
</p>
<blockquote><code><small>
$field_name = mysql_field_name( $result_set, $index )<br />
</small></code></blockquote>
<p>
In the preceding example, the variable $result_set is the result of executing
a SELECT statement, and the variable $index is the index of a specific field
in the current result set.
</p>
<h4>
Filename: columnInfo.php
</h4>
<blockquote><small>
<div class="disp2">
<PRE>
<span class="syntax0"><span class="gutter">   1:</span><span class="syntax17">&lt;?php</span>
<span class="gutter">   2:</span>  <span class="syntax18">@</span> <span class="syntax10">$</span><span class="syntax10">db</span> <span class="syntax18">=</span> <span class="syntax9">mysql_connect</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">localhost</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">djefferson</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">dino1234</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   3:</span>  <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">   4:</span>    <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Connection</span><span class="syntax13"> </span><span class="syntax13">to</span><span class="syntax13"> </span><span class="syntax13">server</span><span class="syntax13"> </span><span class="syntax13">failed:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutterH">   5:</span>  <span class="syntax18">}</span>
<span class="gutter">   6:</span>  <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span> <span class="syntax9">mysql_select_db</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Northwind</span><span class="syntax13">'</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">   7:</span>    <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Database</span><span class="syntax13"> </span><span class="syntax13">select</span><span class="syntax13"> </span><span class="syntax13">error:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   8:</span>  <span class="syntax18">}</span> 
<span class="gutter">   9:</span>  <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">Executing</span><span class="syntax13"> </span><span class="syntax13">SQL...&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutterH">  10:</span>  <span class="syntax10">$</span><span class="syntax10">result</span> <span class="syntax18">=</span> <span class="syntax9">mysql_query</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">SELECT</span><span class="syntax13"> </span><span class="syntax13">*</span><span class="syntax13"> </span><span class="syntax13">FROM</span><span class="syntax13"> </span><span class="syntax13">Customers</span><span class="syntax13">'</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  11:</span>  <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">result</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">  12:</span>    <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Database</span><span class="syntax13"> </span><span class="syntax13">query</span><span class="syntax13"> </span><span class="syntax13">error:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  13:</span>  <span class="syntax18">}</span>
<span class="gutter">  14:</span>
<span class="gutterH">  15:</span>  <span class="syntax8">print</span> <span class="syntax14">&quot;</span><span class="syntax14">&lt;</span><span class="syntax14">table</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
<span class="gutter">  16:</span>  <span class="syntax2">//</span><span class="syntax2"> </span><span class="syntax2">Print</span><span class="syntax2"> </span><span class="syntax2">the</span><span class="syntax2"> </span><span class="syntax2">headers</span>
<span class="gutter">  17:</span>  <span class="syntax8">for</span><span class="syntax18"> (</span><span class="syntax10">$</span><span class="syntax10">c</span><span class="syntax18">=</span><span class="syntax5">0</span><span class="syntax18">;</span> <span class="syntax10">$</span><span class="syntax10">c</span> <span class="syntax18">&lt;</span> <span class="syntax9">mysql_num_fields</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">result</span><span class="syntax18">)</span><span class="syntax18">;</span> <span class="syntax10">$</span><span class="syntax10">c</span><span class="syntax18">+</span><span class="syntax18">+</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">  18:</span>    <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">&lt;th&gt;&lt;u&gt;</span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax9">mysql_field_name</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">result</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">c</span><span class="syntax18">)</span> <span class="syntax18">.</span><span class="syntax13">'</span><span class="syntax13">&lt;/u&gt;&lt;/th&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  19:</span>  <span class="syntax18">}</span>
<span class="gutterH">  20:</span>  <span class="syntax2">//</span><span class="syntax2"> </span><span class="syntax2">Print</span><span class="syntax2"> </span><span class="syntax2">all</span><span class="syntax2"> </span><span class="syntax2">the</span><span class="syntax2"> </span><span class="syntax2">rows</span>
<span class="gutter">  21:</span>  <span class="syntax8">while</span><span class="syntax18"> (</span><span class="syntax10">$</span><span class="syntax10">record</span> <span class="syntax18">=</span> <span class="syntax9">mysql_fetch_row</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">result</span><span class="syntax18">)</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">  22:</span>    <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">&lt;tr&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  23:</span>    <span class="syntax8">for</span><span class="syntax18"> (</span><span class="syntax10">$</span><span class="syntax10">c</span><span class="syntax18">=</span><span class="syntax5">0</span><span class="syntax18">;</span> <span class="syntax10">$</span><span class="syntax10">c</span> <span class="syntax18">&lt;</span> <span class="syntax9">mysql_num_fields</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">result</span><span class="syntax18">)</span><span class="syntax18">;</span> <span class="syntax10">$</span><span class="syntax10">c</span><span class="syntax18">+</span><span class="syntax18">+</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">  24:</span>      <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">&lt;td&gt;</span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax10">$</span><span class="syntax10">record</span><span class="syntax18">[</span><span class="syntax10">$</span><span class="syntax10">c</span><span class="syntax18">]</span> <span class="syntax18">.</span><span class="syntax13">'</span><span class="syntax13">&lt;/td&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutterH">  25:</span>    <span class="syntax18">}</span>
<span class="gutter">  26:</span>    <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">&lt;/tr&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  27:</span>  <span class="syntax18">}</span>
<span class="gutter">  28:</span>  <span class="syntax8">print</span> <span class="syntax13">'</span><span class="syntax13">&lt;/table&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  29:</span><span class="syntax17">?&gt;</span></span>
</PRE>
</div>
</small></blockquote>
<p>
The "Northwind" database is selected as the default database.
</p><p>
All the records from the "Customers" table are selected. The "*" is a wildcard
character for all of the columns, meaning all the fields will be returned.
</p><p>
Because we expect the query to return a lot of data, we use an HTML table to
display the output rather than simply printing it to the screen.
The HTML <b>&lt;table&gt;</b> tag starts the table.
</p><p>
In the for loop, lines 17-19, we print out the headings for the table using
<b>&lt;th&gt;</b> tags. The <b>mysql_num_fields()</b> function returns the number
of fields or columns there are in the "customers" table.
</p><p>
The <b>mysql_field_name()</b> function is used to get the name of a particular
column in a table. The first argument is the result set. The second one is the
index of a particular column or field.
</p><p>
Because we are getting all of the columns with the "SELECT *" clause, the order
will correspond to the column order of the table in the database.
</p><p>
The while loop, lines 21-27, processes all the available rows in the result-set.
All the column values for each row, will be placed within HTML <b>&lt;tr&gt;</b>
tags.
</p><p>
The for loop on lines 23-25 is a nested for loop to process each of the columns
for the current row. The HTML <b>&lt;td&gt;</b> tags are used to place each
column value in a separate table cell.
</p><p>
Once the inner for loop has finished going through each of the fields in the
current row, the loop exits, the HTML <b>&lt;/tr&gt;</b> tag ends each table row,
and control goes back to the while loop where another row from the database is
fetched and then processed.
</p><p>
Finally, the HTML table is ended on line 28. All the data has been retrieved
and displayed.
</p></li>
<li><p>
The Guest Book Example
</p><p>
The following section guides you through an example of building a database-driven
Web site. We will design a guest book application, where visitors to the Web
site can add comments and those comments are visible to others.
</p><p>
Although this is a very simple example, the concepts illustrated here are found
in almost all dynamic Web sites.
</p><p>
You will create a Web form asking the user for some data, insert that data into
the database, and then create another page to display all the data from the database.
</p></li>
<li><p>
Step 1: Designing the Database
</p><p>
As with most database-driven applications, we start by desiging the database
schema. The design process can be a very complex process, but for this example,
we design just one simple table to store messages entered by Web site visitors.
</p><p>
The following example provides the SQL CREATE TABLE command to create the
"messages" table.
</p>
<blockquote><code><pre>
mysql> create TABLE messages(
    -> id INT NOT NULL AUTO_INCREMENT,
    -> subject VARCHAR(150),
    -> body TEXT,
    -> PRIMARY KEY(id))
    -> ;
</pre></code></blockquote>
<p>
The CREATE TABLE statement above creates a database table named "messages".
</p><p>
The first column is named "id". It will be unique identifier for each record
in this table.
</p><p>
It is an integer, meaning a whole number, and NOT NULL indicates that this
field cannot be null, that is, it must have a value.
</p><p>
To ensure that this number is unique, the AUTO_INCREMENT attribute tells MySQL
to increment the "id" field by 1 for each new entry added to the database.
</p><p>
The "subject" column will be variable-length text with a maximum value of
150 characters that is allowed to be NULL and has no default value.
</p><p>
The "body" column will be TEXT of unlimited size. Data type VARCHAR is limited
to 255 characters while a TEXT column may contain up to 65,535 characters.
</p><p>
The "id" field is defined as the PRIMARY KEY of the messages table.
</p><p>
The table has been defined and created. The SQL DESCRIBE command will show you
if the table has been created successfully.
</p><p>
If the table is not as you intended, you can drop the table with the statement:
</p>
<blockquote><code>
DROP TABLE messages;<br />
</code></blockquote>
<p>
and define it again. <b>Note:</b> The DROP TABLE command will delete the entire
table and all its data!
</p>
<code><small><pre>
mysql> describe messages;
+---------+--------------+------+-----+---------+----------------+
| Field   | Type         | Null | Key | Default | Extra          |
+---------+--------------+------+-----+---------+----------------+
| id      | int(11)      | NO   | PRI | NULL    | auto_increment |
| subject | varchar(150) | YES  |     | NULL    |                |
| body    | text         | YES  |     | NULL    |                |
+---------+--------------+------+-----+---------+----------------+
3 rows in set (0.14 sec)
</pre></small></code>
<p>
The SQL DESCRIBE command shows information about the table: the names of the
columns, the data type for each column, whether it should have data,
keys, and so on. You can also use the SHOW command to see the same results.
</p></li>
<li><p>
Step 2: Posting a Message Page
</p><p>
Now that the table has been designed and created, the next step is to create
the Web page containing the HTML form, and the PHP code that will process
the form and enter the posted data into a MySQL database.
</p>
<h4>
Filename: messages.php
</h4>
<blockquote><small>
<div class="disp2">
<PRE>
<span class="syntax0"><span class="gutter">   1:</span><span class="syntax17">&lt;?php</span>
<span class="gutter">   2:</span>  <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax8">empty</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">_POST</span><span class="syntax18">)</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">   3:</span>    <span class="syntax10">$</span><span class="syntax10">subject</span> <span class="syntax18">=</span> <span class="syntax10">$</span><span class="syntax10">_POST</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">subject</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">;</span>
<span class="gutter">   4:</span>    <span class="syntax10">$</span><span class="syntax10">body</span> <span class="syntax18">=</span> <span class="syntax10">$</span><span class="syntax10">_POST</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">body</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">;</span>
<span class="gutterH">   5:</span>  <span class="syntax18">}</span>
<span class="gutter">   6:</span>  <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax8">empty</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">subject</span><span class="syntax18">)</span> <span class="syntax18">&amp;</span><span class="syntax18">&amp;</span> <span class="syntax18">!</span><span class="syntax8">empty</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">body</span><span class="syntax18">)</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">   7:</span>    <span class="syntax18">@</span> <span class="syntax10">$</span><span class="syntax10">db</span> <span class="syntax18">=</span> <span class="syntax9">mysql_connect</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">localhost</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">djefferson</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">dino1234</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   8:</span>    <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">   9:</span>      <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Connection</span><span class="syntax13"> </span><span class="syntax13">to</span><span class="syntax13"> </span><span class="syntax13">server</span><span class="syntax13"> </span><span class="syntax13">failed:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutterH">  10:</span>    <span class="syntax18">}</span>
<span class="gutter">  11:</span>    <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span> <span class="syntax9">mysql_select_db</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">guestbook</span><span class="syntax13">'</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">  12:</span>      <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Database</span><span class="syntax13"> </span><span class="syntax13">select</span><span class="syntax13"> </span><span class="syntax13">error:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  13:</span>    <span class="syntax18">}</span> 
<span class="gutter">  14:</span>    <span class="syntax10">$</span><span class="syntax10">result</span> <span class="syntax18">=</span> <span class="syntax9">mysql_query</span><span class="syntax18">(</span><span class="syntax14">&quot;</span><span class="syntax14">INSERT</span><span class="syntax14"> </span><span class="syntax14">INTO</span><span class="syntax14"> </span><span class="syntax14">messages</span><span class="syntax14"> </span><span class="syntax14">(</span><span class="syntax14">subject</span><span class="syntax14">,</span><span class="syntax14"> </span><span class="syntax14">body</span><span class="syntax14">)</span><span class="syntax14">&quot;</span>
<span class="gutterH">  15:</span>                         <span class="syntax18">.</span><span class="syntax14">&quot;</span><span class="syntax14"> </span><span class="syntax14">VALUES</span><span class="syntax14"> </span><span class="syntax14">(</span><span class="syntax14">'</span><span class="syntax10">$</span><span class="syntax10">subject</span><span class="syntax14">'</span><span class="syntax14">,</span><span class="syntax14">'</span><span class="syntax10">$</span><span class="syntax10">body</span><span class="syntax14">'</span><span class="syntax14">)</span><span class="syntax14">&quot;</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  16:</span>    <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">result</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">  17:</span>        <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Database</span><span class="syntax13"> </span><span class="syntax13">query</span><span class="syntax13"> </span><span class="syntax13">error:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  18:</span>    <span class="syntax18">}</span> 
<span class="gutter">  19:</span>    <span class="syntax10">$</span><span class="syntax10">status</span> <span class="syntax18">=</span> <span class="syntax14">&quot;</span><span class="syntax14">Message</span><span class="syntax14"> </span><span class="syntax14">&lt;</span><span class="syntax14">i</span><span class="syntax14">&gt;</span><span class="syntax10">$</span><span class="syntax10">subject</span><span class="syntax14">&lt;</span><span class="syntax14">/</span><span class="syntax14">i</span><span class="syntax14">&gt;</span><span class="syntax14"> </span><span class="syntax14">has</span><span class="syntax14"> </span><span class="syntax14">been</span><span class="syntax14"> </span><span class="syntax14">posted</span><span class="syntax14">&lt;</span><span class="syntax14">br</span><span class="syntax14"> </span><span class="syntax14">/</span><span class="syntax14">&gt;</span><span class="syntax14">&lt;</span><span class="syntax14">br</span><span class="syntax14"> </span><span class="syntax14">/</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
<span class="gutterH">  20:</span>  <span class="syntax18">}</span>
<span class="gutter">  21:</span><span class="syntax17">?&gt;</span>
<span class="gutter">  22:</span><span class="syntax17">&lt;html</span><span class="syntax17">&gt;</span>
<span class="gutter">  23:</span> <span class="syntax17">&lt;head</span><span class="syntax17">&gt;</span>
<span class="gutter">  24:</span>  <span class="syntax17">&lt;title</span><span class="syntax17">&gt;</span>Guestbook<span class="syntax17">&lt;/title</span><span class="syntax17">&gt;</span>
<span class="gutterH">  25:</span> <span class="syntax17">&lt;/head</span><span class="syntax17">&gt;</span>
<span class="gutter">  26:</span> <span class="syntax17">&lt;body</span><span class="syntax17">&gt;</span>
<span class="gutter">  27:</span>  <span class="syntax17">&lt;h1</span><span class="syntax17">&gt;</span>Post a Message to the Guestbook<span class="syntax17">&lt;/h1</span><span class="syntax17">&gt;</span>
<span class="gutter">  28:</span>  <span class="syntax17">&lt;strong</span><span class="syntax17">&gt;</span><span class="syntax17">&lt;?</span><span class="syntax18">=</span> <span class="syntax10">$</span><span class="syntax10">status</span> <span class="syntax17">?&gt;</span><span class="syntax17">&lt;/strong</span><span class="syntax17">&gt;</span>
<span class="gutter">  29:</span>  <span class="syntax17">&lt;form</span><span class="syntax17"> </span><span class="syntax17">action</span><span class="syntax18">=</span><span class="syntax14">&quot;</span><span class="syntax17">&lt;?</span><span class="syntax18">=</span> <span class="syntax10">$</span><span class="syntax10">_SERVER</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">PHP_SELF</span><span class="syntax13">'</span><span class="syntax18">]</span> <span class="syntax17">?&gt;</span><span class="syntax14">&quot;</span><span class="syntax17"> </span><span class="syntax17">method</span><span class="syntax18">=</span><span class="syntax14">&quot;</span><span class="syntax14">POST</span><span class="syntax14">&quot;</span><span class="syntax17">&gt;</span>
<span class="gutterH">  30:</span>    Subject <span class="syntax17">&lt;input</span><span class="syntax17"> </span><span class="syntax17">type</span><span class="syntax18">=</span><span class="syntax14">&quot;</span><span class="syntax14">text</span><span class="syntax14">&quot;</span><span class="syntax17"> </span><span class="syntax17">name</span><span class="syntax18">=</span><span class="syntax14">&quot;</span><span class="syntax14">subject</span><span class="syntax14">&quot;</span><span class="syntax17"> </span><span class="syntax17">size</span><span class="syntax18">=</span><span class="syntax14">&quot;</span><span class="syntax14">35</span><span class="syntax14">&quot;</span><span class="syntax17">&gt;</span>
<span class="gutter">  31:</span>    <span class="syntax17">&lt;br</span><span class="syntax17"> </span><span class="syntax17">/</span><span class="syntax17">&gt;</span><span class="syntax17">&lt;br</span><span class="syntax17"> </span><span class="syntax17">/</span><span class="syntax17">&gt;</span>
<span class="gutter">  32:</span>    <span class="syntax17">&lt;textarea</span><span class="syntax17"> </span><span class="syntax17">name</span><span class="syntax18">=</span><span class="syntax14">&quot;</span><span class="syntax14">body</span><span class="syntax14">&quot;</span><span class="syntax17"> </span><span class="syntax17">cols</span><span class="syntax18">=</span><span class="syntax14">&quot;</span><span class="syntax14">40</span><span class="syntax14">&quot;</span><span class="syntax17"> </span><span class="syntax17">rows</span><span class="syntax18">=</span><span class="syntax14">&quot;</span><span class="syntax14">15</span><span class="syntax14">&quot;</span><span class="syntax17">&gt;</span><span class="syntax17">&lt;/textarea</span><span class="syntax17">&gt;</span>
<span class="gutter">  33:</span>    <span class="syntax17">&lt;br</span><span class="syntax17"> </span><span class="syntax17">/</span><span class="syntax17">&gt;</span><span class="syntax17">&lt;br</span><span class="syntax17"> </span><span class="syntax17">/</span><span class="syntax17">&gt;</span>
<span class="gutter">  34:</span>    <span class="syntax17">&lt;input</span><span class="syntax17"> </span><span class="syntax17">type</span><span class="syntax18">=</span><span class="syntax14">&quot;</span><span class="syntax14">submit</span><span class="syntax14">&quot;</span><span class="syntax17"> </span><span class="syntax17">value</span><span class="syntax18">=</span><span class="syntax14">&quot;</span><span class="syntax14">Post</span><span class="syntax14">&quot;</span><span class="syntax17">&gt;</span>
<span class="gutterH">  35:</span>  <span class="syntax17">&lt;/form</span><span class="syntax17">&gt;</span>
<span class="gutter">  36:</span> <span class="syntax17">&lt;/body</span><span class="syntax17">&gt;</span>
<span class="gutter">  37:</span><span class="syntax17">&lt;/html</span><span class="syntax17">&gt;</span></span>
</PRE>
</div>
</small></blockquote>
<p>
If the $_POST array has been populated, the form data is assigned to variables
with the same names as the HTML Form input fields.
</p><p>
The first time the user visits this page, no data has been submitted, and the
empty form is displayed.
</p><p>
This is a self-processing form. When the user presses the submit button (labeled
"Post") this page will be displayed again. Remember, $_SERVER['PHP_SELF'] always
points to the current page.
</p><p>
The form is using PHP short_tags. If short_tags are not allowed by the setting
in your php.ini file, line 27 would need to be modified to read:
</p>
<blockquote><code>
&lt;?php echo $_SERVER['PHP_SELF']; ?&gt;<br />
</code></blockquote>
<p>
After connecting to the database server and selecting the correct database,
an SQL statement is executed to INSERT the new record into the messages table.
</p><p>
Setting the $status variable is a nice way to communicate to the user that the
database statement has been successfully executed.
</p></li>
<li><p>
Step 3: Listing All Messages
</p><p>
Once data has been sent to the database, a page is created to list all the
postings in the Guest Book.
</p><p>
The MySQL database is opened and all the fields from the table messages are
selected and printed.
</p>
<h4>
Filename: guestbook.php
</h4>
<blockquote><small>
<div class="disp2">
<PRE>
<span class="syntax0"><span class="gutter">   1:</span><span class="syntax17">&lt;?php</span>
<span class="gutter">   2:</span>  <span class="syntax18">@</span> <span class="syntax10">$</span><span class="syntax10">db</span> <span class="syntax18">=</span> <span class="syntax9">mysql_connect</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">localhost</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">djefferson</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">dino1234</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   3:</span>  <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">   4:</span>    <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Connection</span><span class="syntax13"> </span><span class="syntax13">to</span><span class="syntax13"> </span><span class="syntax13">server</span><span class="syntax13"> </span><span class="syntax13">failed:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutterH">   5:</span>  <span class="syntax18">}</span>
<span class="gutter">   6:</span>  <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span> <span class="syntax9">mysql_select_db</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">guestbook</span><span class="syntax13">'</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">   7:</span>    <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Database</span><span class="syntax13"> </span><span class="syntax13">select</span><span class="syntax13"> </span><span class="syntax13">error:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   8:</span>  <span class="syntax18">}</span> 
<span class="gutter">   9:</span>  <span class="syntax10">$</span><span class="syntax10">result</span> <span class="syntax18">=</span> <span class="syntax9">mysql_query</span><span class="syntax18">(</span><span class="syntax14">&quot;</span><span class="syntax14">SELECT</span><span class="syntax14"> </span><span class="syntax14">*</span><span class="syntax14"> </span><span class="syntax14">FROM</span><span class="syntax14"> </span><span class="syntax14">messages</span><span class="syntax14">&quot;</span><span class="syntax18">,</span> <span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutterH">  10:</span>  <span class="syntax8">if</span><span class="syntax18"> (</span><span class="syntax18">!</span><span class="syntax10">$</span><span class="syntax10">result</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">  11:</span>    <span class="syntax8">exit</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Database</span><span class="syntax13"> </span><span class="syntax13">query</span><span class="syntax13"> </span><span class="syntax13">error:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax9">mysql_error</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">db</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  12:</span>  <span class="syntax18">}</span>
<span class="gutter">  13:</span>  <span class="syntax10">$</span><span class="syntax10">num_messages</span> <span class="syntax18">=</span> <span class="syntax9">mysql_num_rows</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">result</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  14:</span><span class="syntax17">?&gt;</span>
<span class="gutterH">  15:</span><span class="syntax17">&lt;html</span><span class="syntax17">&gt;</span>
<span class="gutter">  16:</span> <span class="syntax17">&lt;head</span><span class="syntax17">&gt;</span>
<span class="gutter">  17:</span>  <span class="syntax17">&lt;title</span><span class="syntax17">&gt;</span>Guestbook<span class="syntax17">&lt;/title</span><span class="syntax17">&gt;</span>
<span class="gutter">  18:</span> <span class="syntax17">&lt;/head</span><span class="syntax17">&gt;</span>
<span class="gutter">  19:</span> <span class="syntax17">&lt;body</span><span class="syntax17">&gt;</span>
<span class="gutterH">  20:</span>  <span class="syntax17">&lt;h1</span><span class="syntax17">&gt;</span>View the Guest Book<span class="syntax17">&lt;/h1</span><span class="syntax17">&gt;</span>
<span class="gutter">  21:</span>  <span class="syntax17">&lt;i</span><span class="syntax17">&gt;</span>There are a total of <span class="syntax17">&lt;?</span><span class="syntax18">=</span> <span class="syntax10">$</span><span class="syntax10">num_messages</span> <span class="syntax17">?&gt;</span> posts to this website.<span class="syntax17">&lt;/i</span><span class="syntax17">&gt;</span>
<span class="gutter">  22:</span>  <span class="syntax17">&lt;br</span><span class="syntax17"> </span><span class="syntax17">/</span><span class="syntax17">&gt;</span><span class="syntax17">&lt;br</span><span class="syntax17"> </span><span class="syntax17">/</span><span class="syntax17">&gt;</span><span class="syntax17">&lt;hr</span><span class="syntax17">&gt;</span>
<span class="gutter">  23:</span>  <span class="syntax17">&lt;?php</span>
<span class="gutter">  24:</span>    <span class="syntax2">//</span><span class="syntax2"> </span><span class="syntax2">Loop</span><span class="syntax2"> </span><span class="syntax2">over</span><span class="syntax2"> </span><span class="syntax2">all</span><span class="syntax2"> </span><span class="syntax2">the</span><span class="syntax2"> </span><span class="syntax2">posts</span><span class="syntax2"> </span><span class="syntax2">and</span><span class="syntax2"> </span><span class="syntax2">print</span><span class="syntax2"> </span><span class="syntax2">them</span><span class="syntax2"> </span><span class="syntax2">out</span>
<span class="gutterH">  25:</span>    <span class="syntax8">while</span><span class="syntax18"> (</span><span class="syntax10">$</span><span class="syntax10">row</span> <span class="syntax18">=</span> <span class="syntax9">mysql_fetch_assoc</span><span class="syntax18">(</span><span class="syntax10">$</span><span class="syntax10">result</span><span class="syntax18">)</span><span class="syntax18">)</span> <span class="syntax18">{</span>
<span class="gutter">  26:</span>      <span class="syntax10">$</span><span class="syntax10">subject</span> <span class="syntax18">=</span> <span class="syntax10">$</span><span class="syntax10">row</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">subject</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">;</span>
<span class="gutter">  27:</span>      <span class="syntax10">$</span><span class="syntax10">body</span> <span class="syntax18">=</span> <span class="syntax10">$</span><span class="syntax10">row</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">body</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">;</span>
<span class="gutter">  28:</span>      <span class="syntax8">print</span> <span class="syntax14">&quot;</span><span class="syntax14">&lt;</span><span class="syntax14">strong</span><span class="syntax14">&gt;</span><span class="syntax10">$</span><span class="syntax10">subject</span><span class="syntax14">&lt;</span><span class="syntax14">/</span><span class="syntax14">strong</span><span class="syntax14">&gt;</span><span class="syntax14">&lt;</span><span class="syntax14">br</span><span class="syntax14"> </span><span class="syntax14">/</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
<span class="gutter">  29:</span>      <span class="syntax8">print</span> <span class="syntax14">&quot;</span><span class="syntax14">&lt;</span><span class="syntax14">pre</span><span class="syntax14">&gt;</span><span class="syntax10">$</span><span class="syntax10">body</span><span class="syntax14">&lt;</span><span class="syntax14">/</span><span class="syntax14">pre</span><span class="syntax14">&gt;</span><span class="syntax14">&lt;</span><span class="syntax14">br</span><span class="syntax14"> </span><span class="syntax14">/</span><span class="syntax14">&gt;</span><span class="syntax14">&lt;</span><span class="syntax14">br</span><span class="syntax14"> </span><span class="syntax14">/</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
<span class="gutterH">  30:</span>    <span class="syntax18">}</span>
<span class="gutter">  31:</span>  <span class="syntax17">?&gt;</span>
<span class="gutter">  32:</span> <span class="syntax17">&lt;/body</span><span class="syntax17">&gt;</span>
<span class="gutter">  33:</span><span class="syntax17">&lt;/html</span><span class="syntax17">&gt;</span></span>
</PRE>
</div>
</small></blockquote>
<p>
The SQL statement in the mysql_query() function selects all columns and rows from
the messages table.
</p><p>
The <b>mysql_num_rows()</b> function returns the total number of rows in the
result set.
</p><p>
The while loop iterates through all the records of the result set.
The <b>mysql_fetch_assoc()</b> function returns an associative array representing
the current row of data.
</p><p>
On lines 26-27 the "subject" and "body" columns of the current row are assigned
to the local variables $subject and $body.
</p></li>
<li><p>
Example Summary
</p><p>
The "Guest Book" example illustrates the main steps needed to create most Web
applications. Let's reexamine the steps involved:
</p>
</li>
</ul>
<blockquote>
<ol type="1">
<li class="row1">
<p>
We start by defining the database and its tables. In this case there is one
table named "messages" consisting of three columns: the unique ID, a subject,
and the body of the message.
</p></li>
<li class="row0">
<p>
Once the database and its tables are defined, all the web pages are designed
that will interact with with it.
</p></li>
<li class="row1">
<p>
The PHP script creates the HTML form where the user can post his or her message
in a text area. After it is submitted, the PHP script calls itself, and the
process of inserting the form data into the database is handled by MySQL
functions.
</p></li>
<li class="row0">
<p>
In the final step, the database is opened and all of the fields from the
"messages" table are displayed. A while loop iterates over all the records
of the result set returned by the SELECT query.
</p></li>
</ol>
</blockquote>
<ul class="slidesUl1">
<p>
</p>
</ul>
</div>
</body>
</html>
