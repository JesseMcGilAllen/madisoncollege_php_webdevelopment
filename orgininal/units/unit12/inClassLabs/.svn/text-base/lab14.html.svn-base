<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

  <meta name="generator" content="HTML Tidy, see www.w3.org" />

  <title>In-class Lab 14</title>
  <link href="basic.css" rel="stylesheet" type="text/css" />

  <script type="text/javascript" language="JavaScript">

<!--

function putSemester() {

    var today=new Date();

    var thisMonth=today.getMonth()+1;

    var thisYear=today.getFullYear();

    if(thisMonth <=6) {

        return "Spring, " + thisYear;

    }

    else {

       return "Fall, " + thisYear;

    }

}//-->

  </script>
 
  <style type="text/css">

<!--

    .bgStripes {

        background-image:url(../../../images/Xstripes.gif);

        background-attachment: fixed;

    }

    

    body {

        background-color:white;

    }

    

    strong {

        font-family: Arial, Helvetica, sans-serif;

    }

    

 

-->

  </style>
</head>


<body style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">

<table class="bgStripes" border="0" width="100%">

  <tbody>

    <tr name="firstRow">

      <td valign="top" width="80"><span style="font-size: x-small; font-weight: bold;">

      <script type="text/javascript">

          <!--

            document.write(putSemester());

            -->

      </script>
      </span> <br />

      </td>

      <td style="text-align: center;"><span style="color: darkblue; font-size: medium; font-weight: bold;">PHP
and MySQL Development</span> </td>

      <td align="right" valign="top" width="80"><span style="font-size: x-small; font-weight: bold;">3
Credits</span> </td>

    </tr>

    <tr>

      <td colspan="3" style="text-align: center;"><span style="font-size: xx-small; font-weight: bold;">152-166</span> </td>

    </tr>

  </tbody>
</table>
<h2>
In-class Lab 14 - Interacting with the File System<br />
</h2>
<ol type="I">
<li class="row0">Exercise 1<br />
<ol type="1">
<li class="row1">
<p>
Sign on to the class MySQL server by executing the following (with your username)
in a terminal window:</p>
<blockquote><code>
ssh astudent@198.150.221.247<br />
</code></blockquote>
</li>
<li class="row1">
<p>
Navigate to your HTML directory on the server:</p>
<blockquote><code>
cd public_html <br />
</code></blockquote>
</li>
<li class="row1">
<p>
Create a directory to upload files to:</p>
<blockquote><code>
mkdir uploads<br />
</code></blockquote>
</li>
<li class="row0">
<p>
Set permissions on the new directory so anybody can upload files: </p>
<blockquote><code>
chmod 0777 uploads<br />
</code></blockquote>
</li>
<li class="row0">
<p>
Copy the <b>upload.html</b> and <b>upload.php</b> files to your HTML directory:</p>
<blockquote><code>
cp /usr/local/apache2/htdocs/WT_text/18/upload.* .<br />
</code></blockquote>
<p>Note that the period (.) at the end of the <b>cp</b> command is essential!</p>
</li>
<li class="row0">
<p>
Edit the upload.php file with the <b>vi</b> text editor:</p>
<blockquote><code>
vi upload.php<br />
</code></blockquote>
</li>
<li class="row0">
<p>
Find the line where the variable <code>$upfile</code>
is defined and change the definition so that the "uploads" directory is
a subdirectory of the directory the script runs in.</p>
</li>
<li class="row0">
<p>
Save the file and exit <b>vi</b> by entering:&nbsp;&nbsp;<b>:wq</b></p>
</li>
<li class="row0">
<p>
Load the <b>upload.html</b> form in a web browser and try uploading a text
file to the class server. If your Linux username on the class server were
<b>astudent</b> , you would use the following URL:
</p>
<blockquote><code>
http://itmysql.matcmadison.edu/~astudent/upload.html<br>
</code></blockquote>
</li>
<li class="row0">
<p>
Show your working script to the instructor.
If you have problems consult the instructor.</p>
</li>
</ol>
</li>
<p><br></p>
<hr width="50%" />
<p><br></p>
<li class="row1">
<p>Exercise 2<br />
</p>
<ol type="1">
<li class="row1">
<p>
Now copy the <b>browsedir.php</b> and <b>filedetails.php</b>
files to your HTML directory:</p>
<blockquote><code>
cp /usr/local/apache2/htdocs/WT_text/18/browsedir.php .<br />
cp /usr/local/apache2/htdocs/WT_text/18/filedetails.php .<br />
</code></blockquote>
</li>
<li class="row1">
<p>
Edit the browsedir.php file with the <b>vi</b> text editor:</p>
<blockquote><code>
vi browsedir.php<br />
</code></blockquote>
</li>
<li class="row1">
<p>
Find the line where the variable <code>$current_dir</code>
is defined and change the definition so that the "uploads" directory is
a subdirectory of the directory the script runs in.</p>
</li>
<li class="row1">
<p>
Then find the while loop and change the echo statement to read <i>exactly</i>
as follows:</p>
<blockquote><code>
echo '&lt;a href="filedetails.php?file='.$file.'"&gt;'.$file.'&lt;/a&gt;&lt;br&gt;';<br />
</code></blockquote>
</li>
<li class="row1">
<p>
Save the file and exit <b>vi</b> by entering:&nbsp;&nbsp;<b>:wq</b></p>
</li>
<li class="row1">
<p>
The <b>filedetails.php</b> script from the text book apparently assumes that
the PHP directive <b>register_globals</b> is turned on.
The class server has this directive turned off for security reasons.
Edit the script with <b>vi</b>
to alter it to get the file name from the appropriate superglobal array.</p>
</li>
<li class="row1">
<p>
Run your modified <b>browsedir.php</b> in a web browser.</p>
</li>
<li class="row1">
<p>
It should allow you to browse the "uploads" directory and get additional
information about the files found by clicking on links.</p>
</li>
<li class="row1">
<p>
Show your working script to the instructor.
If you have problems consult the instructor.</p>
</li>
<br />
</ol>
</li>
</ol>
<hr width="50%" />
</body>
</html>
