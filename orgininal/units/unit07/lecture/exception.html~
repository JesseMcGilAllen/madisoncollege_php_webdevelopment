<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta name="generator" content="HTML Tidy, see www.w3.org">
  <title>Exception Handling</title>
  <link href="../../../css/basic.css" rel="stylesheet" type="text/css">
  <script type="text/javascript" language="JavaScript">

<!--

function putSemester() {

    var today=new Date();

    var thisMonth=today.getMonth()+1;

    var thisYear=today.getFullYear();

    if(thisMonth <=6) {

        return "Spring, " + thisYear;

    }

    else {

       return "Fall, " + thisYear;

    }

}//-->

  </script>
  <style type="text/css">

<!--

    .bgStripes {

        background-image:url(../../../images/Xstripes.gif);

        background-attachment: fixed;

    }

    

    body {

        background-color:white;

    }

    

    strong {

        font-family: Arial, Helvetica, sans-serif;

    }

    

    .table1 {

        font-family:Arial, Helvetica, sans-serif;

        font-size: small;

    }

    

    .table2 {

        font-family:Arial, Helvetica, sans-serif;

        font-size: small;

        text-align:center;

    }

 

    td.cen {

        text-align:center;

    }

    

    .small_title {

        font-family: Arial, Helvetica, sans-serif;

        font-size:x-small;

        font-weight:bold;

    }

    

    .med_title {

        font-family: Arial, Helvetica, sans-serif;

        font-size:medium;

        font-weight:bold;

        text-align:center;

        color:darkblue;

    }



    -->

  </style>
</head>
<body style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<table class="bgStripes" border="0" width="100%">
  <tbody>
    <tr name="firstRow">
      <td valign="top" width="80">
      <p class="small_title">
      <script type="text/javascript">

          <!--

            document.write(putSemester());

            -->

      </script>
      </p>
      <br>
      </td>
      <td>
<p class="med_title"><span
 style="color: darkblue; font-size: medium; font-weight: bold;">
PHP Web Development with MySQL</span></p>
</td>
<td align="right" valign="top" width="80">
<p class="small_title">
3 Credits</p>
</td>
</tr>
<tr>
<td colspan="3" height="10">
<p class="small_title" align="center">152-166</p>
</td>
</tr>
</tbody>
</table>
<!--The heading for the slides --> <br>
<table class="headTable1" border="0">
  <tbody>
    <tr>
      <td width="100"><a href="objphp5.html"><img alt=""
 src="../../../images/btn_lArrow.gif" border="0"></a><a
 href="index.html"><img alt="" src="../../../images/btn_upArrow.gif"
 border="0"></a><a href="index.html"><img alt=""
 src="../../../images/btn_rArrow.gif" border="0"></a></td>
      <td>
<p>
Exception Handling
<br>
</p>
</td>
</tr>
</tbody>
</table>
<br>
<div class="disp1">
<ul class="slidesUl1">
<li>
<p>
In this section, we discuss the concept of exception handling and the way it is
implemented in PHP 5. Exceptions are a new and important feature in PHP 5.
They provide a unified mechanism for handling errors in an extensible,
maintainable, and object-oriented way.</p>
<p>
Exception Handling Concepts</p>
<p>
The basic idea of exception handling is that code is executed inside what
is called a <b>try block</b>.
That is a section of code that looks like this:</p>
<blockquote><code>
try<br>
{<br>
&nbsp;&nbsp;// code goes here<br>
}<br>
</code></blockquote>
<p>
If something goes wrong inside the try block, you can do what is called
"throwing an exception". Some languages, such as Java, throw exceptions
automatically for you in certain cases.
In PHP, exceptions must be thrown manually. You throw an exception as follows:</p>
<blockquote><code>
throw new Exception('message', code);<br>
</code></blockquote>
<p>
The keyword <code>throw</code> triggers the exception handling mechanism.
It is a language construct rather than a function, but you need to pass it a value.
It expects to receive an object. In the simplest case,
you can instantiate the built-in <code>Exception</code> class,
as is done in the example above.</p>
<p>
The constructor for this class takes two parameters: a message and a code.
They are intended to represent an error message and an error code number.
Both of these parameters are optional.</p>
<p>
Finally, underneath your <code>try</code> block,
you need at least one <code>catch</code> block.
A catch block looks like this:</p>
<blockquote><code>
catch (typehint exception )<br>
{<br>
&nbsp;&nbsp;// handle exception<br>
}<br>
</code></blockquote>
<p>
You can have more than one <code>catch</code> block associated with a
single <code>try</code> block. Using more than one would make sense if each
<code>catch</code> block is waiting to catch a different type of exception.
For example, if you want to catch exceptions of the <code>Exception</code> class,
your catch block might look like this:</p>
<blockquote><code>
catch (Exception $e)<br>
{<br>
&nbsp;&nbsp;// handle exception<br>
}<br>
</code></blockquote>
<p>
The object passed into (and caught by) the <code>catch</code> block is the
one passed to (and thrown by) the <code>throw</code> statement that raised
the exception. The exception can be of any type,
but it is good form to use either instances of the <code>Exception</code>
class or instances of your own user-defined exceptions that inherit from the
<code>Exception</code> class.</p>
<p>
When an exception is raised, PHP looks for a matching <code>catch</code> block.
If you have more than one catch block,
the objects passed in to each should be of different types so
that PHP can work out which <code>catch</code> block to fall through to.</p>
<p>
One other point to note is that you can raise further exceptions within a
<code>catch</code> block.</p>
<p>
To make this discussion a bit clearer, we will look at an example.
A simple exception handling example is shown below.
</p>
<h4>
Filename: exception.php
</h4>
<blockquote><small>
<div class="disp2">
<PRE>
<span class="syntax0"><span class="gutter">   1:</span><span class="syntax17">&lt;?php</span>
<span class="gutter">   2:</span>  <span class="syntax2">//</span><span class="syntax2"> </span><span class="syntax2">Throwing</span><span class="syntax2"> </span><span class="syntax2">and</span><span class="syntax2"> </span><span class="syntax2">Catching</span><span class="syntax2"> </span><span class="syntax2">an</span><span class="syntax2"> </span><span class="syntax2">Exception</span>
<span class="gutter">   3:</span>  <span class="syntax8">try</span>
<span class="gutter">   4:</span>  <span class="syntax18">{</span>
<span class="gutterH">   5:</span>    <span class="syntax8">throw</span> <span class="syntax8">new</span> <span class="syntax8">Exception</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">A</span><span class="syntax13"> </span><span class="syntax13">terrible</span><span class="syntax13"> </span><span class="syntax13">error</span><span class="syntax13"> </span><span class="syntax13">has</span><span class="syntax13"> </span><span class="syntax13">occurred</span><span class="syntax13">'</span><span class="syntax18">,</span> <span class="syntax5">42</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">   6:</span>  <span class="syntax18">}</span>
<span class="gutter">   7:</span>  <span class="syntax8">catch</span><span class="syntax18"> (</span><span class="syntax8">Exception</span> <span class="syntax10">$</span><span class="syntax10">e</span><span class="syntax18">)</span>
<span class="gutter">   8:</span>  <span class="syntax18">{</span>
<span class="gutter">   9:</span>    <span class="syntax8">echo</span> <span class="syntax13">'</span><span class="syntax13">Exception</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax11">$e</span><span class="syntax6">-&gt;getCode</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13">:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax11">$e</span><span class="syntax6">-&gt;getMessage</span><span class="syntax18">(</span><span class="syntax18">)</span>
<span class="gutterH">  10:</span>        <span class="syntax18">.</span><span class="syntax13">'</span><span class="syntax13"> </span><span class="syntax13">in</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax11">$e</span><span class="syntax6">-&gt;getFile</span><span class="syntax18">(</span><span class="syntax18">)</span> <span class="syntax18">.</span><span class="syntax13">'</span><span class="syntax13"> </span><span class="syntax13">on</span><span class="syntax13"> </span><span class="syntax13">line</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax11">$e</span><span class="syntax6">-&gt;getLine</span><span class="syntax18">(</span><span class="syntax18">)</span> <span class="syntax18">.</span><span class="syntax13">'</span><span class="syntax13">&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  11:</span>  <span class="syntax18">}</span>
<span class="gutter">  12:</span><span class="syntax17">?&gt;</span>
</span>
</PRE>
</div>
</small></blockquote>
<p>
In the listing above, we used a number of methods of the <code>Exception</code> class,
which we discuss shortly. The result of running this code is that the <code>catch</code>
block reports the exception error message and notes where it occurred.</p>
<p>
In the sample code, you can see that we raise an exception of class <code>Exception</code>.
This built-in class has methods you can use in the <code>catch</code> block
to report a useful error message.</p>
</li>
<li>
<p>
The Exception Class</p>
<p>
PHP 5 comes with a built-in class called <code>Exception</code> .
The constructor takes two parameters, as we discussed previously:
an error message and an error code.</p>
<p>
In addition to the constructor,
this class comes with the following built-in methods:</p>
<ul>
<li>
<code>getCode()</code> - Returns the code as passed to the constructor</li>
<li>
<code>getMessage()</code> - Returns the message as passed to the constructor</li>
<li>
<code>getFile()</code> - Returns the full path to the code file where the
exception was raised</li>
<li>
<code>getLine()</code> - Returns the line number in the code file where the
exception was raised</li>
<li>
<code>getTrace()</code> - Returns an array containing a backtrace where the
exception was raised</li>
<li>
<code>getTraceAsString()</code> - Returns the same information as
<code>getTrace</code> , formatted as a string</li>
<li>
<code>__toString()</code> - Allows you to simply echo an <code>Exception</code>
object, giving all the information from the above methods</li>
</ul>
<p>
We used the first four of these methods in the basic <b>exception.php</b>
example above.
You could obtain the same information (plus the backtrace) by executing:</p>
<blockquote><code>
echo $e;<br>
</code></blockquote>
<p>
A "backtrace" shows which functions were executing at the time the exception was raised.
</p>
</li>
<li>
<p>
User-Defined Exceptions</p>
<p>
Instead of instantiating and passing an instance of the base <code>Exception</code>
class, you can pass any other object you like.
In most cases, you will extend the <code>Exception</code> class to create
your own exception classes.</p>
<p>
You can pass any other object with your <code>throw</code> clause.
You may occasionally want to do this if you are having problems with one
particular object and want to pass it through for debugging purposes.</p>
<p>
Most of the time, however, you will extend the base <code>Exception</code> class.
The PHP manual provides code that shows the skeleton of the <code>Exception</code>
class. This code, taken from <code>http://www.php.net/zend-engine-2.php</code> ,
is reproduced in the listing <a href="../examples/exception_inc.html">exception.inc</a>.
Note that this is not the actual code but represents what you can expect to inherit.
</p>
<p>
The main reason we are looking at this class definition is to note that
most of the public methods are final:
That means you cannot override them.
You can create your own subclass of <code>Exceptions</code> ,
but you cannot change the behavior of the basic methods.
Note that you can override the <code>__toString()</code> function,
so you can change the way the exception is displayed.
You can also add your own methods.</p>
<p>
An example of a user-defined <code>Exception</code> class is shown below.</p>
<p>
<h4>
Filename: userDefExcept.php
</h4>
<blockquote><small>
<div class="disp2">
<PRE>
<span class="syntax0"><span class="gutter">   1:</span><span class="syntax17">&lt;?php</span>
<span class="gutter">   2:</span>  <span class="syntax2">//</span><span class="syntax2"> </span><span class="syntax2">An</span><span class="syntax2"> </span><span class="syntax2">Example</span><span class="syntax2"> </span><span class="syntax2">of</span><span class="syntax2"> </span><span class="syntax2">a</span><span class="syntax2"> </span><span class="syntax2">User-Defined</span><span class="syntax2"> </span><span class="syntax2">Exception</span><span class="syntax2"> </span><span class="syntax2">Class</span>
<span class="gutter">   3:</span>  <span class="syntax8">class</span><span class="syntax8"> </span><span class="syntax11">myException</span><span class="syntax11"> </span><span class="syntax8">extends</span><span class="syntax11"> </span><span class="syntax11">Exception</span>
<span class="gutter">   4:</span><span class="syntax11"> </span><span class="syntax11"> </span><span class="syntax18">{</span>
<span class="gutterH">   5:</span>    <span class="syntax8">function</span> <span class="syntax9">__toString</span><span class="syntax18">(</span><span class="syntax18">)</span>
<span class="gutter">   6:</span>    <span class="syntax18">{</span>
<span class="gutter">   7:</span>      <span class="syntax8">return</span> <span class="syntax13">'</span><span class="syntax13">&lt;table</span><span class="syntax13"> </span><span class="syntax13">border&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Exception</span><span class="syntax13"> </span><span class="syntax13">'</span>
<span class="gutter">   8:</span>            <span class="syntax18">.</span> <span class="syntax11">$this</span><span class="syntax6">-&gt;getCode</span><span class="syntax18">(</span><span class="syntax18">)</span> <span class="syntax18">.</span><span class="syntax13">'</span><span class="syntax13">&lt;/strong&gt;:</span><span class="syntax13"> </span><span class="syntax13">'</span>
<span class="gutter">   9:</span>            <span class="syntax18">.</span> <span class="syntax11">$this</span><span class="syntax6">-&gt;getMessage</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13">&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">.</span><span class="syntax13">'</span><span class="syntax13"> </span><span class="syntax13">in</span><span class="syntax13"> </span><span class="syntax13">'</span>
<span class="gutterH">  10:</span>            <span class="syntax18">.</span> <span class="syntax11">$this</span><span class="syntax6">-&gt;getFile</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13"> </span><span class="syntax13">on</span><span class="syntax13"> </span><span class="syntax13">line</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax11">$this</span><span class="syntax6">-&gt;getLine</span><span class="syntax18">(</span><span class="syntax18">)</span>
<span class="gutter">  11:</span>            <span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13">&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  12:</span>    <span class="syntax18">}</span>
<span class="gutter">  13:</span>  <span class="syntax18">}</span>
<span class="gutter">  14:</span>
<span class="gutterH">  15:</span>  <span class="syntax8">try</span>
<span class="gutter">  16:</span>  <span class="syntax18">{</span>
<span class="gutter">  17:</span>    <span class="syntax8">throw</span> <span class="syntax8">new</span> <span class="syntax6">myException</span><span class="syntax18">(</span> <span class="syntax13">'</span><span class="syntax13">A</span><span class="syntax13"> </span><span class="syntax13">terrible</span><span class="syntax13"> </span><span class="syntax13">error</span><span class="syntax13"> </span><span class="syntax13">has</span><span class="syntax13"> </span><span class="syntax13">occurred</span><span class="syntax13">'</span><span class="syntax18">,</span> <span class="syntax5">42</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="gutter">  18:</span>  <span class="syntax18">}</span>
<span class="gutter">  19:</span>  
<span class="gutterH">  20:</span>  <span class="syntax8">catch</span><span class="syntax18"> (</span>myException <span class="syntax10">$</span><span class="syntax10">m</span><span class="syntax18">)</span>
<span class="gutter">  21:</span>  <span class="syntax18">{</span>
<span class="gutter">  22:</span>    <span class="syntax8">echo</span> <span class="syntax10">$</span><span class="syntax10">m</span><span class="syntax18">;</span>
<span class="gutter">  23:</span>  <span class="syntax18">}</span>
<span class="gutter">  24:</span><span class="syntax17">?&gt;</span></span>
</PRE>
</div>
</small></blockquote>
<p>
In this code, you declare a new exception class, called <code>myException</code> ,
that extends the basic <code>Exception</code> class.
The difference between this class and the <code>Exception</code> class is that
you override the <code>__toString()</code> method to provide a "pretty"
way of printing the exception.</p>
<p>
This example is fairly simple. In the next section, we look at ways to create different
exceptions to deal with different categories of error.</p>
</li>
<li><p>
Exceptions in Bob's Auto Parts</p>
<p>
Suppose we store order data for Bob's Auto Parts in a flat file.
You know that file I/O (in fact, any kind of I/O) is one area in programs
where errors often occur.
This makes it a good place to apply exception handling.</p>
<p>
Thinking about our experience reading and writing files, we can see that three
things are likely to go wrong with writing to the file:
</p>
</li>
</ul>
<blockquote>
<ol type="1">
<li class="row1">
<p>
the file cannot be opened,
</p></li>
<li class="row0">
<p>
a lock cannot be obtained on the file, or
</p></li>
<li class="row1">
<p>
the file cannot be written to.
</p></li>
</ol>
</blockquote>
<ul class="slidesUl1">
<li>
<p>
We created an exception class for each of these possibilities.
The code for these exceptions is shown below.</p>
<p>
<h4>
Filename: fileExcept.php
</h4>
<blockquote><small>
<div class="disp2">
<PRE>
<span class="syntax0"><span class="gutter">   1:</span><span class="syntax17">&lt;?php</span>
<span class="gutter">   2:</span>  <span class="syntax2">//</span><span class="syntax2"> </span><span class="syntax2">File</span><span class="syntax2"> </span><span class="syntax2">I/O-Related</span><span class="syntax2"> </span><span class="syntax2">Exceptions</span>
<span class="gutter">   3:</span>  <span class="syntax8">class</span><span class="syntax8"> </span><span class="syntax11">fileOpenException</span><span class="syntax11"> </span><span class="syntax8">extends</span><span class="syntax11"> </span><span class="syntax11">Exception</span>
<span class="gutter">   4:</span><span class="syntax11"> </span><span class="syntax11"> </span><span class="syntax18">{</span>
<span class="gutterH">   5:</span>    <span class="syntax8">function</span> <span class="syntax9">__toString</span><span class="syntax18">(</span><span class="syntax18">)</span>
<span class="gutter">   6:</span>    <span class="syntax18">{</span>
<span class="gutter">   7:</span>      <span class="syntax8">return</span> <span class="syntax13">'</span><span class="syntax13">fileOpenException</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax11">$this</span><span class="syntax6">-&gt;getCode</span><span class="syntax18">(</span><span class="syntax18">)</span>
<span class="gutter">   8:</span>            <span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13">:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax11">$this</span><span class="syntax6">-&gt;getMessage</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13">&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13"> </span><span class="syntax13">in</span><span class="syntax13"> </span><span class="syntax13">'</span>
<span class="gutter">   9:</span>            <span class="syntax18">.</span> <span class="syntax11">$this</span><span class="syntax6">-&gt;getFile</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13"> </span><span class="syntax13">on</span><span class="syntax13"> </span><span class="syntax13">line</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax11">$this</span><span class="syntax6">-&gt;getLine</span><span class="syntax18">(</span><span class="syntax18">)</span>
<span class="gutterH">  10:</span>            <span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13">&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  11:</span>    <span class="syntax18">}</span>
<span class="gutter">  12:</span>  <span class="syntax18">}</span>
<span class="gutter">  13:</span>  <span class="syntax8">class</span><span class="syntax8"> </span><span class="syntax11">fileWriteException</span><span class="syntax11"> </span><span class="syntax8">extends</span><span class="syntax11"> </span><span class="syntax11">Exception</span>
<span class="gutter">  14:</span><span class="syntax11"> </span><span class="syntax11"> </span><span class="syntax18">{</span>
<span class="gutterH">  15:</span>    <span class="syntax8">function</span> <span class="syntax9">__toString</span><span class="syntax18">(</span><span class="syntax18">)</span>
<span class="gutter">  16:</span>    <span class="syntax18">{</span>
<span class="gutter">  17:</span>      <span class="syntax8">return</span> <span class="syntax13">'</span><span class="syntax13">fileWriteException</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax11">$this</span><span class="syntax6">-&gt;getCode</span><span class="syntax18">(</span><span class="syntax18">)</span>
<span class="gutter">  18:</span>            <span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13">:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax11">$this</span><span class="syntax6">-&gt;getMessage</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13">&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13"> </span><span class="syntax13">in</span><span class="syntax13"> </span><span class="syntax13">'</span>
<span class="gutter">  19:</span>            <span class="syntax18">.</span> <span class="syntax11">$this</span><span class="syntax6">-&gt;getFile</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13"> </span><span class="syntax13">on</span><span class="syntax13"> </span><span class="syntax13">line</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax11">$this</span><span class="syntax6">-&gt;getLine</span><span class="syntax18">(</span><span class="syntax18">)</span>
<span class="gutterH">  20:</span>            <span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13">&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  21:</span>    <span class="syntax18">}</span>
<span class="gutter">  22:</span>  <span class="syntax18">}</span>
<span class="gutter">  23:</span>  <span class="syntax8">class</span><span class="syntax8"> </span><span class="syntax11">fileLockException</span><span class="syntax11"> </span><span class="syntax8">extends</span><span class="syntax11"> </span><span class="syntax11">Exception</span>
<span class="gutter">  24:</span><span class="syntax11"> </span><span class="syntax11"> </span><span class="syntax18">{</span>
<span class="gutterH">  25:</span>    <span class="syntax8">function</span> <span class="syntax9">__toString</span><span class="syntax18">(</span><span class="syntax18">)</span>
<span class="gutter">  26:</span>    <span class="syntax18">{</span>
<span class="gutter">  27:</span>      <span class="syntax8">return</span> <span class="syntax13">'</span><span class="syntax13">fileLockException</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax11">$this</span><span class="syntax6">-&gt;getCode</span><span class="syntax18">(</span><span class="syntax18">)</span>
<span class="gutter">  28:</span>            <span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13">:</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax11">$this</span><span class="syntax6">-&gt;getMessage</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13">&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13"> </span><span class="syntax13">in</span><span class="syntax13"> </span><span class="syntax13">'</span>
<span class="gutter">  29:</span>            <span class="syntax18">.</span> <span class="syntax11">$this</span><span class="syntax6">-&gt;getFile</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13"> </span><span class="syntax13">on</span><span class="syntax13"> </span><span class="syntax13">line</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span> <span class="syntax11">$this</span><span class="syntax6">-&gt;getLine</span><span class="syntax18">(</span><span class="syntax18">)</span>
<span class="gutterH">  30:</span>            <span class="syntax18">.</span> <span class="syntax13">'</span><span class="syntax13">&lt;br</span><span class="syntax13"> </span><span class="syntax13">/&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="gutter">  31:</span>    <span class="syntax18">}</span>
<span class="gutter">  32:</span>  <span class="syntax18">}</span>
<span class="gutter">  33:</span><span class="syntax17">?&gt;</span></span>
</PRE>
</div>
</small></blockquote>
<p>
These <code>Exception</code> subclasses do not do anything particularly interesting.
In fact, for the purpose of this application,
you could leave them as empty subclasses or use the provided
<code>Exception</code> class.
We have, however, provided a <code>__toString()</code> method for each of the
subclasses that explains what type of exception has occurred.</p>
<p>
We wrote a PHP script to process Bob's orders named <b>bobsOrder.php</b> to
incorporate the use of exceptions. This file is shown in listing:
<a href="../examples/processorder_php.html">bobsOrder.php</a>.
</p>
<p>
You can see that the file I/O section of the script is wrapped in a <code>try</code>
block. It is generally considered good coding practice to have small <code>try</code>
blocks and <code>catch</code> the relevant exceptions at the end of each.
This makes your exception handling code easier to write
and maintain because you can see what you are dealing with.</p>
<p>
If you cannot open the file, you throw a <code>fileOpenException</code> ;
if you cannot lock the file, you throw a <code>fileLockException</code> ;
and if you cannot write to the file, you throw a <code>fileWriteException</code> .
</p>
<p>
Look at the <code>catch</code> blocks. To illustrate a point, we have included only two:
one to handle the <code>fileOpenException</code> class and one to handle the
<code>Exception</code> class. Because the other exceptions inherit from
<code>Exception</code> , they will be caught by the second <code>catch</code> block.
Catch blocks are matched on the same basis as the <code>instanceof</code> operator.
This is a good reason for extending your own exception classes from a single class.</p>
<p>
One important warning: If you raise an exception for which you have not written a
matching <code>catch</code> block, PHP will report a fatal error.</p>
</li>
<li>
<p>
Exceptions and PHP's Other Error Handling Mechanisms</p>
<p>
In addition to the exception handling mechanism discussed in this unit, PHP has
complex error handling support, which is beyond the scope of this course.
</p><p>
Note that the process of raising and handling exceptions does not interfere
or prevent other error handling mechanisms from operating.</p>
<p>
In the listing above, notice how the call to <code>fopen()</code> is
prefaced with the "@" error suppression operator.
</p><p>
If the <code>fopen()</code> call fails, PHP would normally issue a warning that
may or may not be displayed or logged depending on the error reporting settings
in your <b>php.ini</b>.
</p>
</li>
<li>
<p>
Further Reading</p>
<p>
Because exception handling is new to PHP, not much has been written on the subject.
However, basic information about exception handling is plentiful.
Sun has a good tutorial about what exceptions are and why you might want to use them
(written from a Java perspective, of course) at:</p>
<p>
<a href="http://java.sun.com/docs/books/tutorial/essential/exceptions/definition.html">
http://java.sun.com/docs/books/tutorial/essential/exceptions/definition.html</a>
</p>
</li>
</ul>
</div>
</body>
</html>
