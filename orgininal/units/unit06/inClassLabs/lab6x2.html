<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta name="generator" content="HTML Tidy, see www.w3.org" />
  <title>In-class Lab 6.2</title>
  <link href="../../../css/basic.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" language="JavaScript">
<!--
function putSemester() {
    var today=new Date();
    var thisMonth=today.getMonth()+1;
    var thisYear=today.getFullYear();
    if(thisMonth <=6) {
        return "Spring, " + thisYear;
    }
    else {
       return "Fall, " + thisYear;
    }
}//-->
  </script>
  <style type="text/css">
<!--
    .bgStripes {
        background-image:url(../../../images/Xstripes.gif);
        background-attachment: fixed;
    }
    body {
        background-color:white;
    }
    strong {
        font-family: Arial, Helvetica, sans-serif;
    }
-->
  </style>
</head>
<body style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<table class="bgStripes" border="0" width="100%">
  <tbody>
    <tr name="firstRow">
      <td valign="top" width="80"><span style="font-size: x-small; font-weight: bold;">
      <script type="text/javascript">
          <!--
            document.write(putSemester());
            -->
      </script>
      </span> <br />
      </td>
<td style="text-align: center;"><span style="color: darkblue; font-size: medium; font-weight: bold;">
PHP Web Development with MySQL</span> </td>
<td align="right" valign="top" width="80"><span style="font-size: x-small; font-weight: bold;">
3 Credits</span> </td>
</tr>
<tr>
<td colspan="3" style="text-align: center;"><span style="font-size: xx-small; font-weight: bold;">
152-166</span> </td>
</tr>
</tbody>
</table>
<h2>In-class Lab 6.2</h2>
<ol type="I">
<li class="row0">
<p>
Exercise 1 - Write functions to format input strings for display and storage
</p>
<ol type="1">
<li class="row0">
<p>
Create a directory named <b>lab06</b> under your <b>labs</b> directory,
which is under your webserver's document root, if it does not already exist.
</p>
</li>
<li class="row1">
<p>
Create a script named <b>lab6x2.inc.php</b> and save it into your
<b>lab06</b> directory.
</p>
</li>
<li class="row1">
<p>
First build a function named <strong><code>format_for_db()</code></strong> that accepts a
string as input and adds "\" characters to it as needed to escape
special characters used by MySQL and other databases. Your function should also
convert any HTML special characters to their non-HTML character equivalents.
</p>
</li>
<li class="row1">
<p>
Step 1 in building <strong><code>format_for_db()</code></strong> is to test whether the
<strong><code>magic_quotes_gpc</code></strong> directive is on, using a PHP built-in function.
</p>
</li>
<li class="row1">
<p>
If "magic quotes" is on, your <strong><code>format_for_db()</code></strong> function does not
need to modify the string to escape characters, because PHP will have already
done so automatically! But, if "magic quotes" is off, your function must call
the PHP built-in function <strong><code>addslashes()</code></strong> to add "\" characters.
</p>
</li>
<li class="row1">
<p>
Your <strong><code>format_for_db()</code></strong> function should call the PHP built-in
function <strong><code>htmlspecialchars_decode()</code></strong> to convert any HTML special
characters to individual non-HTML characters.
</p>
</li>
<li class="row0">
<p>
Finally your function must return the (possibly modified) string to the caller.
</p>
</li>
<li class="row1">
<p>
Now build a function named <strong><code>format_for_display()</code></strong> that accepts a
string as input and removes "\" characters if needed so you can display
it with <b>echo</b> or <b>print</b> and not have extra backslashes
in the output. Your function should also convert any non-HTML characters that
correspond to HTML special characters to their HTML equivalents.
</p>
</li>
<li class="row1">
<p>
Step 1 in building <strong><code>format_for_display()</code></strong> is (again)
to test whether the <strong><code>magic_quotes_gpc</code></strong> directive is on,
using a PHP built-in function.
</p>
</li>
<li class="row1">
<p>
If "magic quotes" is on, your <strong><code>format_for_display()</code></strong> function must
call the PHP built-in function <strong><code>stripslashes()</code></strong>
to remove "\" characters. But, if "magic quotes" is off, your function does not
need to remove any "\" characters.
</p>
</li>
<li class="row1">
<p>
Your <strong><code>format_for_display()</code></strong> function should call the PHP built-in
function <strong><code>htmlspecialchars()</code></strong> to convert any non-HTML characters that
correspond to HTML special characters to their HTML equivalents.
</p>
</li>
<li class="row0">
<p>
Finally the <strong><code>format_for_display()</code></strong> function returns the
(possibly modified) string to the caller.
</p>
</li>
<li class="row0">
<p>
Save your two functions to the <b>lab6x2.inc.php</b> file in your <b>lab06</b>
directory. You will test the functions in Exercise 2.
</p>
</li>
</ol>
</li>
<li class="row0">
<p>
Exercise 2 - Test your functions with user input.
</p>
<ol type="1">
<li class="row1">
<p>
Download the files <a href="lab6form.html.txt">lab6form.html</a> and
<a href="lab6x2.php.txt">lab6x2.php</a> from the Blackboard version of
this lab to your <b>lab06</b> directory.
<p>
</li>
<li class="row1">
<p>
Add a line to <b>lab6x2.php</b> to <strong><code>require()</code></strong>
the file containing your two functions (lab6x2.inc.php).
</p>
</li>
<li class="row0">
<p>
Then, add code to <b>lab6x2.php</b> so that for the name, address and email
address obtained from the user on <b>lab6form</b> it displays the contents
of the variables in three (3) ways:
</p>
<ul>
<li>
"As is" - it already does this (try it).</li>
<li>
After being processed by your <strong><code>format_for_db()</code></strong> function.</li>
<li>
After being processed by your <strong><code>format_for_display()</code></strong> function.</li>
</ul>
</li>
<li class="row0">
<p>
Try the modified <b>lab6x2.php</b> script with the name: Shaun O'Brien<br>
Also, try addresses containing characters such as double quotes, single
quotes, backslashes, and HTML entities such as <b>&amp;nbsp;</b> , <b>&amp;lt;</b>
and <b>&amp;gt;</b> .
</p>
</li>
<li class="row0">
<p>
Show your instructor the modified <b>lab6x2.php</b> script and the
<b>lab6x2.inc.php</b> include file containing your functions.
</p>
</li>
<li class="row0">
<p>
In which cases did your two functions actually modify the input strings?
Why?<br><br>
</p>
<p><hr width="75%" /></p>
</li>
</ol>
</li>
</ol>
</body>
</html>
